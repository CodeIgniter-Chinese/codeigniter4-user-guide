<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>URI 路由 &mdash; CodeIgniter 4.5.1 中文手册|用户手册|用户指南|中文文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme_dark.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="../_static/js/citheme.js"></script>
        <script src="../_static/js/carbon.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="控制器" href="controllers.html" />
    <link rel="prev" title="控制器和路由" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/ci-logo-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">欢迎使用 CodeIgniter4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/index.html">欢迎使用 CodeIgniter4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/requirements.html">服务器需求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/credits.html">致谢</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">PSR 兼容性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">许可协议</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">安装</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Composer 安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">手动安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">运行你的应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">故障排除</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/deployment.html">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">变更记录</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">从前一版本升级</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">CodeIgniter 仓库</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">构建你的第一个应用程序</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">静态页面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">新闻部分</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">创建新闻</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">结束语</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">CodeIgniter4 概览</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">应用程序结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">模型、视图和控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">自动加载文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">工厂</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">处理 HTTP 请求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">安全指南</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">常规主题</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">CodeIgniter URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">全局函数和常量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">记录信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">错误处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">网页缓存</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">AJAX 请求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">代码模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">管理应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">处理多个环境</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">控制器和路由</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">URI 路由</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers.html">控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html">控制器过滤器</a></li>
<li class="toctree-l2"><a class="reference internal" href="message.html">HTTP 消息</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html">请求类</a></li>
<li class="toctree-l2"><a class="reference internal" href="incomingrequest.html">IncomingRequest 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="content_negotiation.html">内容协商</a></li>
<li class="toctree-l2"><a class="reference internal" href="methodspoofing.html">HTTP 方法欺骗</a></li>
<li class="toctree-l2"><a class="reference internal" href="restful.html">RESTful 资源处理</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">构建响应</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">视图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">视图单元</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">视图渲染器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">视图布局</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">视图解析器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">视图装饰器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">HTML 表格类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP 响应</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">API 响应特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">内容安全策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">本地化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">在视图文件中使用 PHP 替代语法</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">使用数据库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">快速入门:使用示例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">数据库配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">连接数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">运行查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">生成查询结果</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">查询辅助方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">查询构建器类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">事务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">获取元数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">自定义函数调用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">数据库事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">数据库实用工具</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">数据建模</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">使用 CodeIgniter 的 Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">使用实体类</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">管理数据库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">使用数据库 Forge 维护数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">数据库迁移</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">数据库填充</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">数据库命令</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">类库参考</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../libraries/caching.html">缓存驱动</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cookies.html">Cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cors.html">跨域资源共享 (CORS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/curlrequest.html">CURLRequest 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/email.html">Email 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/encryption.html">加密服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/files.html">处理文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/file_collections.html">文件集合</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/honeypot.html">蜜罐类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/images.html">图像处理类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/pagination.html">分页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/publisher.html">Publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/sessions.html">Session 库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/throttler.html">限速器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/time.html">时间和日期</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/typography.html">排版</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uploaded_files.html">处理上传的文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uri.html">使用 URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/user_agent.html">User Agent 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/validation.html">验证</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">辅助函数</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../helpers/array_helper.html">数组辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/cookie_helper.html">Cookie 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/date_helper.html">日期辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/filesystem_helper.html">文件系统辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/form_helper.html">表单辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/html_helper.html">HTML 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/inflector_helper.html">Inflector 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/number_helper.html">数字辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/security_helper.html">安全辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/test_helper.html">测试辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/text_helper.html">文本辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/url_helper.html">URL 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/xml_helper.html">XML 辅助函数</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">入门指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">生成数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">测试控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP 测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">测试响应</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/cli.html">测试 CLI 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">模拟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">基准测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">调试应用程序</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">命令行使用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">CLI 概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">通过 CLI 运行控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Spark 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">创建 Spark 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">CLI 生成器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI 库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">CLIRequest 类</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">扩展 CodeIgniter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">创建核心系统类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">替换通用函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">扩展控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">身份验证</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">创建 Composer 包</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">为 CodeIgniter 做贡献</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/official_packages.html">官方包</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodeIgniter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">控制器和路由</a></li>
      <li class="breadcrumb-item active">URI 路由</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="uri">
<h1>URI 路由<a class="headerlink" href="#uri" title="此标题的永久链接"></a></h1>
<nav class="contents local" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#id2" id="id70">什么是 URI 路由?</a></p></li>
<li><p><a class="reference internal" href="#defined-route-routing" id="id71">设置路由规则</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id72">示例</a></p></li>
<li><p><a class="reference internal" href="#http" id="id73">HTTP 动词路由</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id74">指定路由处理程序</a></p>
<ul>
<li><p><a class="reference internal" href="#controllers-namespace" id="id75">控制器的命名空间</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id76">数组可调用语法</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id77">使用闭包</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id10" id="id78">指定路由路径</a></p>
<ul>
<li><p><a class="reference internal" href="#id11" id="id79">占位符</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id80">自定义占位符</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id81">正则表达式</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#view-routes" id="id82">视图路由</a></p></li>
<li><p><a class="reference internal" href="#redirecting-routes" id="id83">重定向路由</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id84">环境限制</a></p></li>
<li><p><a class="reference internal" href="#id18" id="id85">任意 HTTP 动词的路由</a></p></li>
<li><p><a class="reference internal" href="#id19" id="id86">映射多个路由</a></p></li>
<li><p><a class="reference internal" href="#command-line-only-routes" id="id87">仅命令行路由</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id21" id="id88">全局选项</a></p>
<ul>
<li><p><a class="reference internal" href="#applying-filters" id="id89">应用过滤器</a></p>
<ul>
<li><p><a class="reference internal" href="#id23" id="id90">别名过滤器</a></p></li>
<li><p><a class="reference internal" href="#id24" id="id91">类名过滤器</a></p></li>
<li><p><a class="reference internal" href="#multiple-filters" id="id92">多重过滤器</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#assigning-namespace" id="id93">分配命名空间</a></p></li>
<li><p><a class="reference internal" href="#id28" id="id94">限制主机名</a></p></li>
<li><p><a class="reference internal" href="#id29" id="id95">限制子域名</a></p></li>
<li><p><a class="reference internal" href="#id30" id="id96">偏移匹配参数</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#reverse-routing" id="id97">反向路由</a></p></li>
<li><p><a class="reference internal" href="#using-named-routes" id="id98">命名路由</a></p></li>
<li><p><a class="reference internal" href="#id33" id="id99">分组路由</a></p>
<ul>
<li><p><a class="reference internal" href="#id34" id="id100">设置命名空间</a></p></li>
<li><p><a class="reference internal" href="#id35" id="id101">设置过滤器</a></p></li>
<li><p><a class="reference internal" href="#id36" id="id102">设置其他选项</a></p></li>
<li><p><a class="reference internal" href="#routing-nesting-groups" id="id103">嵌套分组</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#routing-priority" id="id104">路由优先级</a></p>
<ul>
<li><p><a class="reference internal" href="#id39" id="id105">更改路由优先级</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#routes-configuration-options" id="id106">路由配置选项</a></p>
<ul>
<li><p><a class="reference internal" href="#routing-default-namespace" id="id107">默认命名空间</a></p></li>
<li><p><a class="reference internal" href="#routing-default-method" id="id108">默认方法</a></p></li>
<li><p><a class="reference internal" href="#id43" id="id109">转换 URI 中的破折号</a></p></li>
<li><p><a class="reference internal" href="#use-defined-routes-only" id="id110">仅使用定义的路由</a></p></li>
<li><p><a class="reference internal" href="#override" id="id111">404 重写</a></p></li>
<li><p><a class="reference internal" href="#id46" id="id112">按优先级处理路由</a></p></li>
<li><p><a class="reference internal" href="#multiple-uri-segments-as-one-parameter" id="id113">将多个 URI 段作为一个参数</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#auto-routing-improved" id="id114">自动路由(改进版)</a></p>
<ul>
<li><p><a class="reference internal" href="#enabled-auto-routing-improved" id="id115">启用自动路由</a></p></li>
<li><p><a class="reference internal" href="#id50" id="id116">URI 段</a></p></li>
<li><p><a class="reference internal" href="#routing-auto-routing-improved-configuration-options" id="id117">配置选项</a></p>
<ul>
<li><p><a class="reference internal" href="#id52" id="id118">默认控制器</a></p></li>
<li><p><a class="reference internal" href="#routing-auto-routing-improved-default-method" id="id119">默认方法</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#auto-routing-improved-module-routing" id="id120">模块路由</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#auto-routing-legacy" id="id121">自动路由(传统)</a></p>
<ul>
<li><p><a class="reference internal" href="#id58" id="id122">启用自动路由(传统)</a></p></li>
<li><p><a class="reference internal" href="#id59" id="id123">URI 段(传统)</a></p></li>
<li><p><a class="reference internal" href="#routing-auto-routing-legacy-configuration-options" id="id124">配置选项(传统)</a></p>
<ul>
<li><p><a class="reference internal" href="#id61" id="id125">默认控制器(传统)</a></p></li>
<li><p><a class="reference internal" href="#routing-auto-routing-legacy-default-method" id="id126">默认方法(传统)</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id65" id="id127">确认路由</a></p>
<ul>
<li><p><a class="reference internal" href="#spark" id="id128">spark 路由</a></p>
<ul>
<li><p><a class="reference internal" href="#id66" id="id129">自动路由(改进版)</a></p></li>
<li><p><a class="reference internal" href="#id67" id="id130">自动路由(传统)</a></p></li>
<li><p><a class="reference internal" href="#routing-spark-routes-sort-by-handler" id="id131">按处理程序排序</a></p></li>
<li><p><a class="reference internal" href="#routing-spark-routes-specify-host" id="id132">指定主机</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="id2">
<h2><a class="toc-backref" href="#id70" role="doc-backlink">什么是 URI 路由?</a><a class="headerlink" href="#id2" title="此标题的永久链接"></a></h2>
<p>URI 路由将一个 URI 与一个控制器的方法相关联。</p>
<p>CodeIgniter 有两种路由方式。一种是 <strong>定义路由</strong>,另一种是 <strong>自动路由</strong>。
通过定义路由,你可以手动定义路由规则。它允许灵活的 URL。
自动路由根据约定自动将 HTTP 请求路由到相应的控制器方法。无需手动定义路由。</p>
<p>首先,让我们看看定义路由。如果你想使用自动路由,请参阅 <a class="reference internal" href="#auto-routing-improved"><span class="std std-ref">自动路由(改进版)</span></a>。</p>
</section>
<section id="defined-route-routing">
<span id="id3"></span><h2><a class="toc-backref" href="#id71" role="doc-backlink">设置路由规则</a><a class="headerlink" href="#defined-route-routing" title="此标题的永久链接"></a></h2>
<p>路由规则定义在 <strong>app/Config/Routes.php</strong> 文件中。你会看到它实例化了
RouteCollection 类 (<code class="docutils literal notranslate"><span class="pre">$routes</span></code>),允许你指定自己的路由标准。
路由可以使用占位符或正则表达式来指定。</p>
<p>在指定路由时,你要为对应的 HTTP 动词(请求方法)选择一个方法。
如果你期望一个 GET 请求,请使用 <code class="docutils literal notranslate"><span class="pre">get()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;Home::index&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>一个路由将 <strong>路由路径</strong> (相对于 BaseURL 的 URI 路径, <code class="docutils literal notranslate"><span class="pre">/</span></code>)放在左边,
并将其映射到右边的 <strong>路由处理程序</strong> (控制器和方法 <code class="docutils literal notranslate"><span class="pre">Home::index</span></code>),
以及应该传递给控制器的任何参数。</p>
<p>控制器和方法应该用双冒号 <code class="docutils literal notranslate"><span class="pre">::</span></code> 分隔类和方法的方式列出,就像使用静态方法 <code class="docutils literal notranslate"><span class="pre">Users::list</span></code> 一样。</p>
<p>如果该方法需要传递参数,则它们应该在方法名后以正斜杠分隔列出:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Calls $Users-&gt;list()</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::list&#39;</span><span class="p">);</span>

<span class="c1">// Calls $Users-&gt;list(1, 23)</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/1/23&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::list/1/23&#39;</span><span class="p">);</span>
</pre></div>
</div>
<section id="id4">
<h3><a class="toc-backref" href="#id72" role="doc-backlink">示例</a><a class="headerlink" href="#id4" title="此标题的永久链接"></a></h3>
<p>这是一些基本的路由示例。</p>
<p>URL 的第一个段包含 <strong>journals</strong> 的情况下，会被映射到 <code class="docutils literal notranslate"><span class="pre">\App\Controllers\Blogs</span></code> 类，
以及 <a class="reference internal" href="#routing-default-method"><span class="std std-ref">默认方法</span></a>，通常是 <code class="docutils literal notranslate"><span class="pre">index()</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;journals&#39;</span><span class="p">,</span> <span class="s1">&#39;Blogs&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>包含路径段 <strong>blog/joe</strong> 的 URL 将被映射到 <code class="docutils literal notranslate"><span class="pre">\App\Controllers\Blogs</span></code> 类的 <code class="docutils literal notranslate"><span class="pre">users()</span></code> 方法。
ID 将被设置为 <code class="docutils literal notranslate"><span class="pre">34</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;blog/joe&#39;</span><span class="p">,</span> <span class="s1">&#39;Blogs::users/34&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>以 <strong>product</strong> 作为第一个段的 URL,任何内容作为第二段,将被映射到 <code class="docutils literal notranslate"><span class="pre">\App\Controllers\Catalog</span></code> 类
和 <code class="docutils literal notranslate"><span class="pre">productLookup()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:segment)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookup&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>以 <strong>product</strong> 作为第一个段,数字作为第二段的 URL,将被映射到 <code class="docutils literal notranslate"><span class="pre">\App\Controllers\Catalog</span></code> 类
和 <code class="docutils literal notranslate"><span class="pre">productLookupByID()</span></code> 方法,并将匹配项作为变量传递给该方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookupByID/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="http">
<span id="routing-http-verb-routes"></span><h3><a class="toc-backref" href="#id73" role="doc-backlink">HTTP 动词路由</a><a class="headerlink" href="#http" title="此标题的永久链接"></a></h3>
<p>你可以使用任何标准的 HTTP 动词(GET、POST、PUT、DELETE、OPTIONS 等):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::feature&#39;</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">&#39;products/1&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::feature&#39;</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">&#39;products/1&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::feature&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>你可以通过将它们作为数组传递给 <code class="docutils literal notranslate"><span class="pre">match()</span></code> 方法来指定路由应匹配的多个动词:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">match</span><span class="p">([</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">],</span> <span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::feature&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">指定路由处理程序</a><a class="headerlink" href="#id5" title="此标题的永久链接"></a></h3>
<section id="controllers-namespace">
<span id="id6"></span><h4><a class="toc-backref" href="#id75" role="doc-backlink">控制器的命名空间</a><a class="headerlink" href="#controllers-namespace" title="此标题的永久链接"></a></h4>
<p>当你以字符串的形式指定控制器和方法名称时,如果控制器没有以 <code class="docutils literal notranslate"><span class="pre">\</span></code> 开头,
将会在前面加上 <a class="reference internal" href="#routing-default-namespace"><span class="std std-ref">默认命名空间</span></a>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Routes to \App\Controllers\Api\Users::update()</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;api/users&#39;</span><span class="p">,</span> <span class="s1">&#39;Api\Users::update&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>如果你在开头加上 <code class="docutils literal notranslate"><span class="pre">\</span></code>,它将被视为完全限定的类名:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Routes to \Acme\Blog\Controllers\Home::list()</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;blog&#39;</span><span class="p">,</span> <span class="s1">&#39;\Acme\Blog\Controllers\Home::list&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>你也可以使用 <code class="docutils literal notranslate"><span class="pre">namespace</span></code> 选项指定命名空间:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Routes to \Admin\Users::index()</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin/users&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;namespace&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Admin&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>详细信息请参阅 <a class="reference internal" href="#assigning-namespace"><span class="std std-ref">分配命名空间</span></a>。</p>
</section>
<section id="id7">
<h4><a class="toc-backref" href="#id76" role="doc-backlink">数组可调用语法</a><a class="headerlink" href="#id7" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>自 v4.2.0 起,你可以使用数组可调用语法来指定控制器:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">\App\Controllers\Home</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>或者使用 <code class="docutils literal notranslate"><span class="pre">use</span></code> 关键字:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Controllers\Home</span><span class="p">;</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Home</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>如果你忘记添加 <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">App\Controllers\Home;</span></code>，控制器类名会被解释为 <code class="docutils literal notranslate"><span class="pre">\Home</span></code>，而不是 <code class="docutils literal notranslate"><span class="pre">App\Controllers\Home</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当你使用数组可调用语法时,类名总是被解释为完全限定的类名。
所以 <a class="reference internal" href="#routing-default-namespace"><span class="std std-ref">默认命名空间</span></a> 和 <a class="reference internal" href="#assigning-namespace"><span class="std std-ref">namespace 选项</span></a>
没有效果。</p>
</div>
<section id="id8">
<h5>数组可调用语法和占位符<a class="headerlink" href="#id8" title="此标题的永久链接"></a></h5>
<p>如果有占位符,它将自动按指定顺序设置参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Controllers\Product</span><span class="p">;</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Product</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">]);</span>

<span class="c1">// The above code is the same as the following:</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::index/$1/$2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>但是,如果在路由中使用正则表达式,自动配置的参数可能不正确。
在这种情况下,你可以手动指定参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Controllers\Product</span><span class="p">;</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="nx">Product</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="s1">&#39;$2/$1&#39;</span><span class="p">]);</span>

<span class="c1">// The above code is the same as the following:</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::index/$2/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="id9">
<h4><a class="toc-backref" href="#id77" role="doc-backlink">使用闭包</a><a class="headerlink" href="#id9" title="此标题的永久链接"></a></h4>
<p>你可以使用匿名函数或闭包作为路由映射的目标。当用户访问该 URI 时,此函数将被执行。
这对于快速执行小任务或只显示简单视图很方便:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">App\Libraries\RSSFeeder</span><span class="p">;</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;feed&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nv">$rss</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RSSFeeder</span><span class="p">();</span>

    <span class="k">return</span> <span class="nv">$rss</span><span class="o">-&gt;</span><span class="na">feed</span><span class="p">(</span><span class="s1">&#39;general&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h3><a class="toc-backref" href="#id78" role="doc-backlink">指定路由路径</a><a class="headerlink" href="#id10" title="此标题的永久链接"></a></h3>
<section id="id11">
<h4><a class="toc-backref" href="#id79" role="doc-backlink">占位符</a><a class="headerlink" href="#id11" title="此标题的永久链接"></a></h4>
<p>一个典型的路由可能如下所示:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookup&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>在路由中,第一个参数包含要匹配的 URI,而第二个参数包含它应该路由到的目标。
在上面的示例中,如果在 URL 路径的第一个段中找到了字面词“product”,并且在第二个段中找到了一个数字,
则使用 <code class="docutils literal notranslate"><span class="pre">Catalog</span></code> 类和 <code class="docutils literal notranslate"><span class="pre">productLookup</span></code> 方法。</p>
<p>占位符只是代表正则表达式模式的字符串。在路由过程中,这些占位符会被正则表达式的值替换。
它们主要用于可读性。</p>
<p>你可以在路由中使用以下占位符:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>占位符</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(:any)</p></td>
<td><p>将匹配从那点到 URI 结尾的所有字符。这可能包括多个 URI 段。</p></td>
</tr>
<tr class="row-odd"><td><p>(:segment)</p></td>
<td><p>将匹配任何除正斜杠 (<code class="docutils literal notranslate"><span class="pre">/</span></code>) 之外的字符,限制结果为单个段。</p></td>
</tr>
<tr class="row-even"><td><p>(:num)</p></td>
<td><p>将匹配任何整数。</p></td>
</tr>
<tr class="row-odd"><td><p>(:alpha)</p></td>
<td><p>将匹配任何字母字符字符串</p></td>
</tr>
<tr class="row-even"><td><p>(:alphanum)</p></td>
<td><p>将匹配任何字母字符字符串或整数,或两者的任意组合。</p></td>
</tr>
<tr class="row-odd"><td><p>(:hash)</p></td>
<td><p>与 <code class="docutils literal notranslate"><span class="pre">(:segment)</span></code> 相同,但可以用来轻松看出哪些路由使用散列 ID。</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">{locale}</span></code> 不能作为占位符或路由的其他部分使用,因为它保留用于
<a class="reference internal" href="../outgoing/localization.html"><span class="doc">localization</span></a>。</p>
</div>
<section id="any">
<span id="routing-placeholder-any"></span><h5>(:any) 的行为<a class="headerlink" href="#any" title="此标题的永久链接"></a></h5>
<p>请注意,单个 <code class="docutils literal notranslate"><span class="pre">(:any)</span></code> 将在 URL 中匹配多个段(如果存在)。</p>
<p>例如,路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:any)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookup/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>将匹配 <strong>product/123</strong>、<strong>product/123/456</strong>、<strong>product/123/456/789</strong> 等等。</p>
<p>默认情况下，在上面的例子中，如果 <code class="docutils literal notranslate"><span class="pre">$1</span></code> 占位符包含斜杠（<code class="docutils literal notranslate"><span class="pre">/</span></code>），在传递给
<code class="docutils literal notranslate"><span class="pre">Catalog::productLookup()</span></code> 时，它仍然会被拆分为多个参数。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>自 v4.5.0 起，你可以通过配置选项更改此行为。
详情请参见 <a class="reference internal" href="#multiple-uri-segments-as-one-parameter"><span class="std std-ref">将多个 URI 段作为一个参数</span></a>。</p>
</div>
<p>控制器中的实现应考虑最大参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Controllers</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Catalog</span> <span class="k">extends</span> <span class="nx">BaseController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">productLookup</span><span class="p">(</span><span class="nv">$seg1</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$seg2</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$seg3</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$seg1</span><span class="p">;</span> <span class="c1">// Will be 123 in all examples</span>
        <span class="k">echo</span> <span class="nv">$seg2</span><span class="p">;</span> <span class="c1">// false in first, 456 in second and third example</span>
        <span class="k">echo</span> <span class="nv">$seg3</span><span class="p">;</span> <span class="c1">// false in first and second, 789 in third</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>或者你可以使用 <a class="reference external" href="https://www.php.net/manual/en/functions.arguments.php#functions.variable-arg-list">变长参数列表</a>：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Controllers</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Catalog</span> <span class="k">extends</span> <span class="nx">BaseController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">productLookup</span><span class="p">(</span><span class="o">...</span><span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// Will be 123 in all examples</span>
        <span class="k">echo</span> <span class="nv">$params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// null in first, 456 in second and third example</span>
        <span class="k">echo</span> <span class="nv">$params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// null in first and second, 789 in third</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>不要在 <code class="docutils literal notranslate"><span class="pre">(:any)</span></code> 后面放任何占位符。因为传递给控制器方法的参数数量可能会改变。</p>
</div>
<p>如果匹配多个段不是预期的行为,那么在定义路由时应该使用 <code class="docutils literal notranslate"><span class="pre">(:segment)</span></code>。对于上面的示例 URL:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:segment)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookup/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>将只匹配 <strong>product/123</strong>,其余示例将生成 404 错误。</p>
</section>
</section>
<section id="id13">
<h4><a class="toc-backref" href="#id80" role="doc-backlink">自定义占位符</a><a class="headerlink" href="#id13" title="此标题的永久链接"></a></h4>
<p>你可以创建自己的占位符,在路由文件中使用它们以完全自定义体验和可读性。</p>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">addPlaceholder()</span></code> 方法添加新占位符。第一个参数是将用作占位符的字符串。
第二个参数是它应该被替换的正则表达式模式。这必须在添加路由之前调用:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">addPlaceholder</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="s1">&#39;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&#39;</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/(:uuid)&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::show/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id14">
<h4><a class="toc-backref" href="#id81" role="doc-backlink">正则表达式</a><a class="headerlink" href="#id14" title="此标题的永久链接"></a></h4>
<p>如果你愿意,可以使用正则表达式来定义路由规则。允许任何有效的正则表达式,以及反向引用。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>注意:如果使用反向引用,必须使用美元语法而不是双反斜杠语法。
一个典型的 RegEx 路由可能如下所示:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;products/([a-z]+)/(\d+)&#39;</span><span class="p">,</span> <span class="s1">&#39;Products::show/$1/id_$2&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>在上面的示例中,类似于 <strong>products/shirts/123</strong> 的 URI 将调用 <code class="docutils literal notranslate"><span class="pre">Products</span></code>
控制器类的 <code class="docutils literal notranslate"><span class="pre">show()</span></code> 方法,并将原始的第一个和第二个段作为参数传递给它。</p>
<p>使用正则表达式,你也可以捕获包含正斜杠 (<code class="docutils literal notranslate"><span class="pre">/</span></code>) 的段,通常表示多个段之间的分隔符。</p>
<p>例如,如果用户访问你的 Web 应用程序的密码保护区域,并且你希望能够在他们登录后将他们重定向回同一页面,你可能会发现此示例很有用:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;login/(.+)&#39;</span><span class="p">,</span> <span class="s1">&#39;Auth::login/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>默认情况下，在上面的例子中，如果 <code class="docutils literal notranslate"><span class="pre">$1</span></code> 占位符包含斜杠（<code class="docutils literal notranslate"><span class="pre">/</span></code>），在传递给
<code class="docutils literal notranslate"><span class="pre">Auth::login()</span></code> 时，它仍然会被拆分为多个参数。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>自 v4.5.0 起，你可以通过配置选项更改此行为。
详情请参见 <a class="reference internal" href="#multiple-uri-segments-as-one-parameter"><span class="std std-ref">将多个 URI 段作为一个参数</span></a>。</p>
</div>
<p>对于那些不了解正则表达式并希望学习更多知识的人,`regular-expressions.info &lt;<a class="reference external" href="https://www.regular-expressions.info/">https://www.regular-expressions.info/</a>&gt;`_ 可能是一个不错的起点。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>你也可以将占位符与正则表达式结合使用。</p>
</div>
</section>
</section>
<section id="view-routes">
<span id="id15"></span><h3><a class="toc-backref" href="#id82" role="doc-backlink">视图路由</a><a class="headerlink" href="#view-routes" title="此标题的永久链接"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>如果你只想渲染一个没有关联逻辑的视图,你可以使用 <code class="docutils literal notranslate"><span class="pre">view()</span></code> 方法。这始终被视为 GET 请求。
该方法接受要加载的视图名称作为第二个参数。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Displays the view in /app/Views/pages/about.php</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;about&#39;</span><span class="p">,</span> <span class="s1">&#39;pages/about&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>如果在路由中使用占位符,则可以在名为 <code class="docutils literal notranslate"><span class="pre">$segments</span></code> 的特殊变量中访问它们。它们以数组形式提供,索引顺序与路由中的出现顺序相同。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Displays the view in /app/Views/map.php</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;map/(:segment)/(:segment)&#39;</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">);</span>

<span class="c1">// Within the view, you can access the segments with</span>
<span class="c1">// $segments[0] and $segments[1] respectively.</span>
</pre></div>
</div>
</section>
<section id="redirecting-routes">
<span id="id16"></span><h3><a class="toc-backref" href="#id83" role="doc-backlink">重定向路由</a><a class="headerlink" href="#redirecting-routes" title="此标题的永久链接"></a></h3>
<p>任何存在足够长的站点都会有页面移动的情况。你可以使用 <code class="docutils literal notranslate"><span class="pre">addRedirect()</span></code> 方法指定应重定向到其他路由的路由。
第一个参数是旧路由的 URI 模式。第二个参数是重定向的新 URI,或命名路由的名称。
第三个参数是应随重定向一起发送的 HTTP 状态码。默认值为 <code class="docutils literal notranslate"><span class="pre">302</span></code>,这是临时重定向,在大多数情况下都推荐使用:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/profile&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::profile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;as&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;profile&#39;</span><span class="p">]);</span>

<span class="c1">// Redirect to a named route</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">addRedirect</span><span class="p">(</span><span class="s1">&#39;users/about&#39;</span><span class="p">,</span> <span class="s1">&#39;profile&#39;</span><span class="p">);</span>
<span class="c1">// Redirect to a URI</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">addRedirect</span><span class="p">(</span><span class="s1">&#39;users/about&#39;</span><span class="p">,</span> <span class="s1">&#39;users/profile&#39;</span><span class="p">);</span>

<span class="c1">// Redirect with placeholder</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;post/(:num)/comment/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;PostsComments::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;as&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;post.comment&#39;</span><span class="p">]);</span>

<span class="c1">// Redirect to a URI</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">addRedirect</span><span class="p">(</span><span class="s1">&#39;article/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;post/$1/comment/$2&#39;</span><span class="p">);</span>
<span class="c1">// Redirect to a named route</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">addRedirect</span><span class="p">(</span><span class="s1">&#39;article/(:num)/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;post.comment&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>自 v4.2.0 起, <code class="docutils literal notranslate"><span class="pre">addRedirect()</span></code> 可以使用占位符。</p>
</div>
<p>如果在页面加载期间匹配到重定向路由,用户将在控制器加载之前立即重定向到新页面。</p>
</section>
<section id="id17">
<h3><a class="toc-backref" href="#id84" role="doc-backlink">环境限制</a><a class="headerlink" href="#id17" title="此标题的永久链接"></a></h3>
<p>你可以创建一组路由,这些路由只能在某些环境中查看。这允许你创建仅开发人员才能在其本地机器上使用的工具,这些工具在测试或生产服务器上无法访问。
可以使用 <code class="docutils literal notranslate"><span class="pre">environment()</span></code> 方法来完成。第一个参数是环境的名称。此闭包中定义的任何路由只能从给定环境访问:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">environment</span><span class="p">(</span><span class="s1">&#39;development&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;builder&#39;</span><span class="p">,</span> <span class="s1">&#39;Tools\Builder::index&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3><a class="toc-backref" href="#id85" role="doc-backlink">任意 HTTP 动词的路由</a><a class="headerlink" href="#id18" title="此标题的永久链接"></a></h3>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>这个方法只为了向后兼容而存在。在新项目中不要使用它。即使你已经在使用它，我们也建议你使用另一种更适合的方法。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>尽管 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法看起来很方便,但建议始终使用基于 HTTP 动词的路由,如上所述,因为它更安全。
如果你使用 <a class="reference internal" href="../libraries/security.html"><span class="doc">CSRF 保护</span></a>,它不会保护 <strong>GET</strong> 请求。
如果 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法中指定的 URI 可以通过 GET 方法访问,CSRF 保护将不起作用。</p>
</div>
<p>可以定义具有任意 HTTP 动词的路由。你可以使用 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="s1">&#39;Product::feature&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>使用基于 HTTP 动词的路由还会提供略微的性能提升,因为只存储与当前请求方法匹配的路由,
从而在尝试找到匹配项时扫描的路由更少。</p>
</div>
</section>
<section id="id19">
<h3><a class="toc-backref" href="#id86" role="doc-backlink">映射多个路由</a><a class="headerlink" href="#id19" title="此标题的永久链接"></a></h3>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>这个方法只为了向后兼容而存在。在新项目中不要使用它。即使你已经在使用它，我们也建议你使用另一种更适合的方法。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>不推荐使用 <code class="docutils literal notranslate"><span class="pre">map()</span></code> 方法,就像 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 一样,因为它在内部调用 <code class="docutils literal notranslate"><span class="pre">add()</span></code>。</p>
</div>
<p>尽管 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法使用简单,但通常更方便的是同时使用多个路由,使用 <code class="docutils literal notranslate"><span class="pre">map()</span></code> 方法。
你可以定义一个路由数组,然后将其作为第一个参数传递给 <code class="docutils literal notranslate"><span class="pre">map()</span></code> 方法,而不是为你需要添加的每个路由调用 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$multipleRoutes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;product/(:num)&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Catalog::productLookupById&#39;</span><span class="p">,</span>
    <span class="s1">&#39;product/(:alphanum)&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Catalog::productLookupByName&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">map</span><span class="p">(</span><span class="nv">$multipleRoutes</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="command-line-only-routes">
<span id="id20"></span><h3><a class="toc-backref" href="#id87" role="doc-backlink">仅命令行路由</a><a class="headerlink" href="#command-line-only-routes" title="此标题的永久链接"></a></h3>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>建议使用 Spark 命令作为 CLI 脚本,而不是通过 CLI 调用控制器。请参阅
<a class="reference internal" href="../cli/cli_commands.html"><span class="doc">创建 Spark 命令</span></a> 页面以获取详细信息。</p>
</div>
<p>任何通过基于 HTTP 动词的路由方法创建的路由也将无法从 CLI 访问，但通过 <code class="docutils literal notranslate"><span class="pre">add()</span></code> 方法创建的路由仍然可以从命令行访问。</p>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">cli()</span></code> 方法创建只能从命令行使用、无法从 Web 浏览器访问的路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">cli</span><span class="p">(</span><span class="s1">&#39;migrate&#39;</span><span class="p">,</span> <span class="s1">&#39;App\Database::migrate&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果启用 <a class="reference internal" href="#auto-routing-legacy"><span class="std std-ref">自动路由(传统)</span></a> 并将命令文件放在 <strong>app/Controllers</strong> 中,
任何人都可以在 Auto Routing(传统)的帮助下通过 HTTP 访问该命令。</p>
</div>
</section>
</section>
<section id="id21">
<h2><a class="toc-backref" href="#id88" role="doc-backlink">全局选项</a><a class="headerlink" href="#id21" title="此标题的永久链接"></a></h2>
<p>创建路由的所有方法(<code class="docutils literal notranslate"><span class="pre">get()</span></code>、<code class="docutils literal notranslate"><span class="pre">post()</span></code>、<a class="reference internal" href="restful.html"><span class="doc">resource()</span></a> 等)都可以带有一个选项数组,
以修改生成的路由或进一步限制它们。<code class="docutils literal notranslate"><span class="pre">$options</span></code> 数组始终是最后一个参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">head</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">options</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">patch</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">match</span><span class="p">([</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">],</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">resource</span><span class="p">(</span><span class="s1">&#39;photos&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">map</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nv">$options</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{});</span>
</pre></div>
</div>
<section id="applying-filters">
<span id="id22"></span><h3><a class="toc-backref" href="#id89" role="doc-backlink">应用过滤器</a><a class="headerlink" href="#applying-filters" title="此标题的永久链接"></a></h3>
<p>你可以通过在控制器之前或之后提供要运行的过滤器来更改特定路由的行为。这在认证或 API 日志记录时特别方便。
过滤器的值可以是字符串或字符串数组:</p>
<ul class="simple">
<li><p>与 <strong>app/Config/Filters.php</strong> 中定义的别名匹配。</p></li>
<li><p>过滤器类名</p></li>
</ul>
<p>有关设置过滤器的更多信息,请参阅 <a class="reference internal" href="filters.html"><span class="doc">控制器过滤器</span></a>。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果你在 <strong>app/Config/Routes.php</strong> 中为路由设置过滤器(而不是在 <strong>app/Config/Filters.php</strong> 中)
建议禁用 Auto Routing(传统)。当启用 <a class="reference internal" href="#auto-routing-legacy"><span class="std std-ref">自动路由(传统)</span></a> 时,控制器可能可以通过与配置路由不同的 URL 访问,
在这种情况下,你为该路由指定的过滤器将不会应用。请参阅 <a class="reference internal" href="#use-defined-routes-only"><span class="std std-ref">仅使用定义的路由</span></a> 以禁用自动路由。</p>
</div>
<section id="id23">
<h4><a class="toc-backref" href="#id90" role="doc-backlink">别名过滤器</a><a class="headerlink" href="#id23" title="此标题的永久链接"></a></h4>
<p>你为过滤器值指定在 <strong>app/Config/Filters.php</strong> 中定义的别名:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39; AdminController::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin-auth&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>你还可以提供要传递给别名过滤器的 <code class="docutils literal notranslate"><span class="pre">before()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">after()</span></code> 方法的参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;users/delete/(:segment)&#39;</span><span class="p">,</span> <span class="s1">&#39;AdminController::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin-auth:dual,noreturn&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</section>
<section id="id24">
<h4><a class="toc-backref" href="#id91" role="doc-backlink">类名过滤器</a><a class="headerlink" href="#id24" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.1.5 版本加入.</span></p>
</div>
<p>你可以为过滤器值指定过滤器类名:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39; AdminController::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="nx">\App\Filters\SomeFilter</span><span class="o">::</span><span class="na">class</span><span class="p">]);</span>
</pre></div>
</div>
</section>
<section id="multiple-filters">
<span id="id25"></span><h4><a class="toc-backref" href="#id92" role="doc-backlink">多重过滤器</a><a class="headerlink" href="#multiple-filters" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.1.5 版本加入.</span></p>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>自 v4.5.0 起，<em>多重过滤器</em> 始终启用。
在 v4.5.0 之前，<em>多重过滤器</em> 默认是禁用的。
如果你想在 v4.5.0 之前的版本中使用，请参见
<a class="reference internal" href="../installation/upgrade_415.html#upgrade-415-multiple-filters-for-a-route"><span class="std std-ref">从 4.1.4 升级到 4.1.5</span></a>
了解详情。</p>
</div>
<p>你可以为过滤器值指定一个数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39; AdminController::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;admin-auth&#39;</span><span class="p">,</span> <span class="nx">\App\Filters\SomeFilter</span><span class="o">::</span><span class="na">class</span><span class="p">]]);</span>
</pre></div>
</div>
<section id="id26">
<h5>过滤器参数<a class="headerlink" href="#id26" title="此标题的永久链接"></a></h5>
<p>可以向过滤器传递额外的参数：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;users/delete/(:segment)&#39;</span><span class="p">,</span> <span class="s1">&#39;AdminController::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;admin-auth:dual,noreturn&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>在这个例子中，数组 <code class="docutils literal notranslate"><span class="pre">['dual',</span> <span class="pre">'noreturn']</span></code> 将作为 <code class="docutils literal notranslate"><span class="pre">$arguments</span></code> 传递给过滤器的 <code class="docutils literal notranslate"><span class="pre">before()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">after()</span></code> 实现方法。</p>
</section>
</section>
</section>
<section id="assigning-namespace">
<span id="id27"></span><h3><a class="toc-backref" href="#id93" role="doc-backlink">分配命名空间</a><a class="headerlink" href="#assigning-namespace" title="此标题的永久链接"></a></h3>
<p>虽然 <a class="reference internal" href="#routing-default-namespace"><span class="std std-ref">默认命名空间</span></a> 将被预先添加到生成的控制器中,
但你也可以在任何选项数组中使用 <code class="docutils literal notranslate"><span class="pre">namespace</span></code> 选项指定要使用的不同命名空间。
值应该是要修改的命名空间:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Routes to \Admin\Users::index()</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin/users&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;namespace&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Admin&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>新的命名空间仅在该调用期间应用于任何创建单个路由的方法,如 get、post 等。
对于创建多个路由的任何方法,新的命名空间将附加到该函数生成的所有路由,或者在 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 的情况下,附加到闭包中生成的所有路由。</p>
</section>
<section id="id28">
<h3><a class="toc-backref" href="#id94" role="doc-backlink">限制主机名</a><a class="headerlink" href="#id28" title="此标题的永久链接"></a></h3>
<p>你可以通过在选项数组中传递“hostname”选项以及允许的域来限制路由组仅在应用程序的某些域或子域中运行:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;hostname&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;accounts.example.com&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>此示例只允许指定主机在域完全匹配 <strong>accounts.example.com</strong> 时工作。
它不会在主站点 <strong>example.com</strong> 中工作。</p>
</section>
<section id="id29">
<h3><a class="toc-backref" href="#id95" role="doc-backlink">限制子域名</a><a class="headerlink" href="#id29" title="此标题的永久链接"></a></h3>
<p>当存在 <code class="docutils literal notranslate"><span class="pre">subdomain</span></code> 选项时,系统将只允许路由在该子域上可用。仅当应用程序正在查看的子域是路由定义的子域时,才会匹配该路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Limit to media.example.com</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;subdomain&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;media&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>你可以通过将值设置为星号 (<code class="docutils literal notranslate"><span class="pre">*</span></code>) 来限制到任何子域。如果你从一个没有任何子域存在的 URL 查看,这将不会匹配:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Limit to any sub-domain</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;subdomain&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;*&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>该系统并不完美,在生产中使用之前,应针对你的特定域进行测试。大多数域都应正常工作,但某些极端情况的域,尤其是域本身中包含句点(不用于分隔后缀或 www)的域可能会导致误报。</p>
</div>
</section>
<section id="id30">
<h3><a class="toc-backref" href="#id96" role="doc-backlink">偏移匹配参数</a><a class="headerlink" href="#id30" title="此标题的永久链接"></a></h3>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">offset</span></code> 选项以任意数字值偏移路由中的匹配参数,值是要偏移的段数。</p>
<p>当使用 API 的第一个 URI 段是版本号时,这很有用。它也可以在第一个参数是语言字符串时使用:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;users/show/$1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;offset&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">]);</span>

<span class="c1">// Creates:</span>
<span class="nv">$routes</span><span class="p">[</span><span class="s1">&#39;users/(:num)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;users/show/$2&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
<section id="reverse-routing">
<span id="id31"></span><h2><a class="toc-backref" href="#id97" role="doc-backlink">反向路由</a><a class="headerlink" href="#reverse-routing" title="此标题的永久链接"></a></h2>
<p>反向路由允许你定义控制器和方法,以及任何参数,使链接应该指向的位置,并让路由器查找当前路由。
这允许路由定义更改而不必更新应用程序代码。这通常在视图中用于创建链接。</p>
<p>例如,如果你有一个指向相册的路由要链接到,你可以使用 <a class="reference internal" href="../helpers/url_helper.html#url_to" title="url_to"><code class="xref php php-func docutils literal notranslate"><span class="pre">url_to()</span></code></a> 辅助函数来获取应该使用的路由。
第一个参数是用双冒号 (<code class="docutils literal notranslate"><span class="pre">::</span></code>) 分隔的完全限定的控制器和方法,就像编写初始路由本身一样。
任何应该传递给路由的参数在后面传入:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// The route is defined as:</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/(:num)/gallery/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Galleries::showUserGallery/$1/$2&#39;</span><span class="p">);</span>

<span class="cp">?&gt;</span>

<span class="cm">&lt;!-- Generate the URI to link to user ID 15, gallery 12: --&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nx">url_to</span><span class="p">(</span><span class="s1">&#39;Galleries::showUserGallery&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span><span class="p">&gt;</span>View Gallery<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="cm">&lt;!-- Result: &#39;http://example.com/users/15/gallery/12&#39; --&gt;</span>
</pre></div>
</div>
</section>
<section id="using-named-routes">
<span id="id32"></span><h2><a class="toc-backref" href="#id98" role="doc-backlink">命名路由</a><a class="headerlink" href="#using-named-routes" title="此标题的永久链接"></a></h2>
<p>你可以命名路由以使应用程序更加健壮。这会给路由指定一个名称,以后可以调用此名称,即使路由定义发生更改,
使用 <a class="reference internal" href="../helpers/url_helper.html#url_to" title="url_to"><code class="xref php php-func docutils literal notranslate"><span class="pre">url_to()</span></code></a> 构建的应用程序中的所有链接也仍然有效,而无需进行任何更改。
通过传递 <code class="docutils literal notranslate"><span class="pre">as</span></code> 选项及路由名称来命名路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// The route is defined as:</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users/(:num)/gallery/(:num)&#39;</span><span class="p">,</span> <span class="s1">&#39;Galleries::showUserGallery/$1/$2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;as&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;user_gallery&#39;</span><span class="p">]);</span>

<span class="cp">?&gt;</span>

<span class="cm">&lt;!-- Generate the URI to link to user ID 15, gallery 12: --&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nx">url_to</span><span class="p">(</span><span class="s1">&#39;user_gallery&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">&quot;</span><span class="p">&gt;</span>View Gallery<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<span class="cm">&lt;!-- Result: &#39;http://example.com/users/15/gallery/12&#39; --&gt;</span>
</pre></div>
</div>
<p>这也使视图更具可读性。</p>
</section>
<section id="id33">
<h2><a class="toc-backref" href="#id99" role="doc-backlink">分组路由</a><a class="headerlink" href="#id33" title="此标题的永久链接"></a></h2>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 方法在共同名称下对路由进行分组。组名称成为出现在组内定义的路由之前的一个段。
这允许你减少构建共享开头字符串的大量路由所需的输入,例如构建管理区域:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Users::index&#39;</span><span class="p">);</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;blog&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Blog::index&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>这将为 <strong>users</strong> 和 <strong>blog</strong> URI 添加前缀 <strong>admin</strong>,处理像 <strong>admin/users</strong> 和 <strong>admin/blog</strong> 这样的 URL。</p>
<section id="id34">
<h3><a class="toc-backref" href="#id100" role="doc-backlink">设置命名空间</a><a class="headerlink" href="#id34" title="此标题的永久链接"></a></h3>
<p>如果你需要为组分配选项,如 <a class="reference internal" href="#assigning-namespace"><span class="std std-ref">分配命名空间</span></a>,请在回调之前执行:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;namespace&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;App\API\v1&#39;</span><span class="p">],</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">resource</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>这将处理指向 <code class="docutils literal notranslate"><span class="pre">App\API\v1\Users</span></code> 控制器的资源路由,URI 为 <strong>api/users</strong>。</p>
</section>
<section id="id35">
<h3><a class="toc-backref" href="#id101" role="doc-backlink">设置过滤器</a><a class="headerlink" href="#id35" title="此标题的永久链接"></a></h3>
<p>你还可以为路由组使用特定的 <a class="reference internal" href="filters.html"><span class="doc">过滤器</span></a>。这将始终在控制器之前或之后运行过滤器。
这在认证或 API 日志记录时特别方便:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;api-auth&#39;</span><span class="p">],</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">resource</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>过滤器的值必须与 <strong>app/Config/Filters.php</strong> 内定义的别名之一匹配。</p>
</section>
<section id="id36">
<h3><a class="toc-backref" href="#id102" role="doc-backlink">设置其他选项</a><a class="headerlink" href="#id36" title="此标题的永久链接"></a></h3>
<p>在某些时候,你可能要对路由进行分组以应用过滤器或其他路由配置选项,如命名空间、子域名等,而不一定需要为组添加前缀。
你可以传入空字符串代替前缀,该组中的路由将路由,就好像组从未存在过一样,但具有给定的路由配置选项:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;namespace&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Myth\Auth\Controllers&#39;</span><span class="p">],</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;AuthController::login&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;as&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span><span class="p">]);</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;AuthController::attemptLogin&#39;</span><span class="p">);</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="s1">&#39;AuthController::logout&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="routing-nesting-groups">
<span id="id37"></span><h3><a class="toc-backref" href="#id103" role="doc-backlink">嵌套分组</a><a class="headerlink" href="#routing-nesting-groups" title="此标题的永久链接"></a></h3>
<p>如果需要,可以在组内嵌套组进行更细粒度的组织:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;myfilter:config&#39;</span><span class="p">],</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Admin::index&#39;</span><span class="p">);</span>

    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;filter&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;myfilter:region&#39;</span><span class="p">],</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Users::list&#39;</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>这将处理在 <strong>admin/users/list</strong> 的 URL。</p>
<p><strong>Filter</strong> 选项传递给外部的 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 时，会与内部的 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 过滤器选项合并。
上述代码对路由 <code class="docutils literal notranslate"><span class="pre">admin</span></code> 运行 <code class="docutils literal notranslate"><span class="pre">myfilter:config</span></code>，对路由 <code class="docutils literal notranslate"><span class="pre">admin/users/list</span></code> 运行 <code class="docutils literal notranslate"><span class="pre">myfilter:config</span></code> 和 <code class="docutils literal notranslate"><span class="pre">myfilter:region</span></code>。</p>
<p>任何传递给内部 <cite>group()</cite> 的其他重叠选项都会覆盖它们的值。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在 v4.5.0 之前，由于一个错误，传递给外部 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 的选项不会与内部 <code class="docutils literal notranslate"><span class="pre">group()</span></code> 的选项合并。</p>
</div>
</section>
</section>
<section id="routing-priority">
<span id="id38"></span><h2><a class="toc-backref" href="#id104" role="doc-backlink">路由优先级</a><a class="headerlink" href="#routing-priority" title="此标题的永久链接"></a></h2>
<p>路由以它们被定义的顺序注册到路由表中。这意味着当访问一个 URI 时,第一个匹配的路由将被执行。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果使用不同的处理程序多次定义路由路径,则只注册第一个定义的路由。</p>
</div>
<p>你可以通过运行 <a class="reference internal" href="#routing-spark-routes"><span class="std std-ref">spark routes</span></a> 命令来检查路由表中的注册路由。</p>
<section id="id39">
<h3><a class="toc-backref" href="#id105" role="doc-backlink">更改路由优先级</a><a class="headerlink" href="#id39" title="此标题的永久链接"></a></h3>
<p>在使用模块时,如果应用程序中的路由包含通配符,则模块路由将无法正确处理。
你可以通过使用 <code class="docutils literal notranslate"><span class="pre">priority</span></code> 选项降低路由处理优先级来解决此问题。该参数接受正整数和零。
在 <code class="docutils literal notranslate"><span class="pre">priority</span></code> 中指定的数字越高,处理队列中的路由优先级越低:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// First you need to enable processing of the routes queue by priority.</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setPrioritize</span><span class="p">();</span>

<span class="c1">// Config\Routes</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;(.*)&#39;</span><span class="p">,</span> <span class="s1">&#39;Posts::index&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;priority&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">]);</span>

<span class="c1">// Modules\Acme\Config\Routes</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin::index&#39;</span><span class="p">);</span>

<span class="c1">// The &quot;admin&quot; route will now be processed before the wildcard route.</span>
</pre></div>
</div>
<p>要禁用此功能,必须使用 <code class="docutils literal notranslate"><span class="pre">false</span></code> 参数调用该方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setPrioritize</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>默认情况下,所有路由的优先级都是 0。负整数将被转换为绝对值。</p>
</div>
</section>
</section>
<section id="routes-configuration-options">
<span id="id40"></span><h2><a class="toc-backref" href="#id106" role="doc-backlink">路由配置选项</a><a class="headerlink" href="#routes-configuration-options" title="此标题的永久链接"></a></h2>
<p>RoutesCollection 类提供了几个选项，可以影响所有路由，并且可以根据你的应用程序需求进行修改。这些选项可以在 <strong>app/Config/Routing.php</strong> 文件中找到。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>配置文件 <strong>app/Config/Routing.php</strong> 自 v4.4.0 版本开始添加。
在之前的版本中，使用 <strong>app/Config/Routes.php</strong> 中的 setter 方法来更改设置。</p>
</div>
<section id="routing-default-namespace">
<span id="id41"></span><h3><a class="toc-backref" href="#id107" role="doc-backlink">默认命名空间</a><a class="headerlink" href="#routing-default-namespace" title="此标题的永久链接"></a></h3>
<p>在将控制器与路由匹配时,路由器会在路由指定的控制器前面添加默认的命名空间值。
默认值为 <code class="docutils literal notranslate"><span class="pre">App\\Controllers</span></code>。</p>
<p>如果你将值设置为空字符串 (<code class="docutils literal notranslate"><span class="pre">''</span></code>),它会让每个路由指定完全限定的控制器:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$defaultNamespace</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// In app/Config/Routes.php</span>
<span class="c1">// Controller is \Users</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::index&#39;</span><span class="p">);</span>

<span class="c1">// Controller is \Admin\Users</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Users::index&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>如果你的控制器没有明确指定命名空间,则不需要更改此值。如果你的控制器指定了命名空间,那么你可以更改此值以节省输入:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// This can be overridden in app/Config/Routes.php</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setDefaultNamespace</span><span class="p">(</span><span class="s1">&#39;App&#39;</span><span class="p">);</span>

<span class="c1">// Controller is \App\Users</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Users::index&#39;</span><span class="p">);</span>

<span class="c1">// Controller is \App\Admin\Users</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;Admin\Users::index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="routing-default-method">
<span id="id42"></span><h3><a class="toc-backref" href="#id108" role="doc-backlink">默认方法</a><a class="headerlink" href="#routing-default-method" title="此标题的永久链接"></a></h3>
<p>该设置在路由处理器只有控制器名称而没有方法名称列出时使用。默认值是 <code class="docutils literal notranslate"><span class="pre">index</span></code>。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="c1">// 在 app/Config/Routing.php 中</span>
<span class="k">public</span> <span class="nx">string</span> <span class="nv">$defaultMethod</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">$defaultMethod</span></code> 也常用于自动路由。
请参见 <a class="reference internal" href="#routing-auto-routing-improved-default-method"><span class="std std-ref">自动路由（改进版）</span></a>
或 <a class="reference internal" href="#routing-auto-routing-legacy-default-method"><span class="std std-ref">自动路由（传统版）</span></a>。</p>
</div>
<p>如果你定义了以下路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;Home&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>当路由匹配时，将执行 <code class="docutils literal notranslate"><span class="pre">App\Controllers\Home</span></code> 控制器的 <code class="docutils literal notranslate"><span class="pre">index()</span></code> 方法。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>方法名称以 <code class="docutils literal notranslate"><span class="pre">_</span></code> 开头时不能用作默认方法。
但是，从 v4.5.0 开始，允许使用 <code class="docutils literal notranslate"><span class="pre">__invoke</span></code> 方法。</p>
</div>
</section>
<section id="id43">
<h3><a class="toc-backref" href="#id109" role="doc-backlink">转换 URI 中的破折号</a><a class="headerlink" href="#id43" title="此标题的永久链接"></a></h3>
<p>该选项允许你在使用自动路由时，自动将控制器和方法的 URI 段中的破折号（<code class="docutils literal notranslate"><span class="pre">-</span></code>）替换为下划线，从而节省了额外的路由条目。这是必需的，因为破折号不是有效的类或方法名称字符，如果你尝试使用它，将会导致致命错误：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$translateURIDashes</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// This can be overridden in app/Config/Routes.php</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setTranslateURIDashes</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在使用自动路由（改进版）时，在 v4.4.0 之前，如果 <code class="docutils literal notranslate"><span class="pre">$translateURIDashes</span></code> 为 true，两个 URI 对应一个控制器方法，一个 URI 用于破折号（例如 <strong>foo-bar</strong>），另一个 URI 用于下划线（例如 <strong>foo_bar</strong>）。这是错误的行为。从 v4.4.0 开始，下划线的 URI（<strong>foo_bar</strong>）不可访问。</p>
</div>
</section>
<section id="use-defined-routes-only">
<span id="id44"></span><h3><a class="toc-backref" href="#id110" role="doc-backlink">仅使用定义的路由</a><a class="headerlink" href="#use-defined-routes-only" title="此标题的永久链接"></a></h3>
<p>自 v4.2.0 起,默认禁用自动路由。</p>
<p>当未找到与当前 URI 匹配的定义路由时,如果启用了自动路由,系统将尝试将该 URI 与控制器和方法匹配。</p>
<p>你可以通过将 <code class="docutils literal notranslate"><span class="pre">$autoRoute</span></code> 属性设置为 false 来禁用此自动匹配,
并且只限制路由为你定义的路由:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$autoRoute</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// This can be overridden in app/Config/Routes.php</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setAutoRoute</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果你使用 <a class="reference internal" href="../libraries/security.html"><span class="doc">CSRF 保护</span></a>,它不会保护 <strong>GET</strong> 请求。
如果 URI 可以通过 GET 方法访问,CSRF 保护将不起作用。</p>
</div>
</section>
<section id="override">
<span id="id45"></span><h3><a class="toc-backref" href="#id111" role="doc-backlink">404 重写</a><a class="headerlink" href="#override" title="此标题的永久链接"></a></h3>
<p>当找不到与当前 URI 匹配的页面时，系统将显示一个通用的 404 页面。通过在路由配置文件中使用 <code class="docutils literal notranslate"><span class="pre">$override404</span></code> 属性，你可以为 404 路由定义控制器类/方法。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="o">?</span><span class="nx">string</span> <span class="nv">$override404</span> <span class="o">=</span> <span class="s1">&#39;App\Errors::show404&#39;</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>你还可以在路由配置文件中使用 <code class="docutils literal notranslate"><span class="pre">set404Override()</span></code> 方法指定在发生 404 错误时执行的操作。该值可以是一个有效的类/方法对，或者是一个闭包：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routes.php</span>
<span class="c1">// Would execute the show404 method of the App\Errors class</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">set404Override</span><span class="p">(</span><span class="s1">&#39;App\Errors::show404&#39;</span><span class="p">);</span>

<span class="c1">// Will display a custom view.</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">set404Override</span><span class="p">(</span><span class="k">static</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// If you want to get the URI segments.</span>
    <span class="nv">$segments</span> <span class="o">=</span> <span class="nx">request</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getUri</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getSegments</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;my_errors/not_found.html&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v4.5.0 开始，404 覆盖功能默认将响应状态代码设置为 <code class="docutils literal notranslate"><span class="pre">404</span></code>。在之前的版本中，状态代码是 <code class="docutils literal notranslate"><span class="pre">200</span></code>。
如果你想在控制器中更改状态代码，请参见 <a class="reference internal" href="../outgoing/response.html#CodeIgniter\HTTP\Response::setStatusCode" title="CodeIgniter\HTTP\Response::setStatusCode"><code class="xref php php-meth docutils literal notranslate"><span class="pre">CodeIgniter\HTTP\Response::setStatusCode()</span></code></a> 获取有关如何设置状态代码的信息。</p>
</div>
</section>
<section id="id46">
<h3><a class="toc-backref" href="#id112" role="doc-backlink">按优先级处理路由</a><a class="headerlink" href="#id46" title="此标题的永久链接"></a></h3>
<p>启用或禁用按优先级处理路由队列。在路由选项中降低优先级。默认禁用。
此功能影响所有路由。有关降低优先级的示例用法,请参阅 <a class="reference internal" href="#routing-priority"><span class="std std-ref">路由优先级</span></a>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$prioritize</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// In app/Config/Routes.php</span>
<span class="c1">// to enable</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setPrioritize</span><span class="p">();</span>

<span class="c1">// to disable</span>
<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">setPrioritize</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="multiple-uri-segments-as-one-parameter">
<span id="id47"></span><h3><a class="toc-backref" href="#id113" role="doc-backlink">将多个 URI 段作为一个参数</a><a class="headerlink" href="#multiple-uri-segments-as-one-parameter" title="此标题的永久链接"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">在 4.5.0 版本加入.</span></p>
</div>
<p>启用此选项时，匹配多个段的占位符，例如 <code class="docutils literal notranslate"><span class="pre">(:any)</span></code>，将直接按原样传递给一个参数，即使它包含多个段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// In app/Config/Routing.php</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Config\Routing</span> <span class="k">as</span> <span class="nx">BaseRouting</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Routing</span> <span class="k">extends</span> <span class="nx">BaseRouting</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$multipleSegmentsOneParam</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>例如，以下路由：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;product/(:any)&#39;</span><span class="p">,</span> <span class="s1">&#39;Catalog::productLookup/$1&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>将匹配 <strong>product/123</strong>、<strong>product/123/456</strong>、<strong>product/123/456/789</strong> 等等。
如果 URI 是 <strong>product/123/456</strong>，<code class="docutils literal notranslate"><span class="pre">123/456</span></code> 将被传递给 <code class="docutils literal notranslate"><span class="pre">Catalog::productLookup()</span></code> 方法的第一个参数。</p>
</section>
</section>
<section id="auto-routing-improved">
<span id="id48"></span><h2><a class="toc-backref" href="#id114" role="doc-backlink">自动路由(改进版)</a><a class="headerlink" href="#auto-routing-improved" title="此标题的永久链接"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>自 v4.2.0 起,引入了新的更安全的自动路由。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果你熟悉自动路由,在 CodeIgniter 3.x 到 4.1.x 中默认启用,
你可以在 <a class="reference internal" href="../changelogs/v4.2.0.html#v420-new-improved-auto-routing"><span class="std std-ref">ChangeLog v4.2.0</span></a> 中看到区别。</p>
</div>
<p>当未找到与 URI 匹配的定义路由时,如果启用了自动路由,系统将尝试将该 URI 与控制器和方法匹配。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>出于安全考虑,如果控制器在定义的路由中使用,自动路由(改进版)不会路由到该控制器。</p>
</div>
<p>自动路由可以根据约定自动路由 HTTP 请求,并执行相应的控制器方法。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>自动路由(改进版)默认禁用。要使用它,请参阅下文。</p>
</div>
<section id="enabled-auto-routing-improved">
<span id="id49"></span><h3><a class="toc-backref" href="#id115" role="doc-backlink">启用自动路由</a><a class="headerlink" href="#enabled-auto-routing-improved" title="此标题的永久链接"></a></h3>
<p>要使用它,你需要在 <strong>app/Config/Routing.php</strong> 中将 <code class="docutils literal notranslate"><span class="pre">$autoRoute</span></code> 选项设置为 <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">bool</span> <span class="nv">$autoRoute</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</pre></div>
</div>
<p>并且你需要在 <strong>app/Config/Feature.php</strong> 中将属性 <code class="docutils literal notranslate"><span class="pre">$autoRoutesImproved</span></code> 设置为 <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">bool</span> <span class="nv">$autoRoutesImproved</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id50">
<h3><a class="toc-backref" href="#id116" role="doc-backlink">URI 段</a><a class="headerlink" href="#id50" title="此标题的永久链接"></a></h3>
<p>按照 MVC 方法,URL 中的段通常代表:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nx">example</span><span class="o">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">class</span><span class="o">/</span><span class="nx">method</span><span class="o">/</span><span class="nx">ID</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>第一个段表示要调用的控制器 <strong>类</strong>。</p></li>
<li><p>第二个段表示要调用的类 <strong>方法</strong>。</p></li>
<li><p>第三个及任何其他段表示要传递给控制器的 ID 和任何变量。</p></li>
</ol>
<p>考虑此 URI:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nx">example</span><span class="o">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span><span class="o">/</span><span class="nx">helloworld</span><span class="o">/</span><span class="nx">hello</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
<p>在上面的示例中,当发送 <strong>GET</strong> 方法的 HTTP 请求时,自动路由会尝试找到名为 <code class="docutils literal notranslate"><span class="pre">App\Controllers\Helloworld</span></code> 的控制器,
并使用 <code class="docutils literal notranslate"><span class="pre">'1'</span></code> 作为第一个参数执行 <code class="docutils literal notranslate"><span class="pre">getHello()</span></code> 方法。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>自动路由(改进版)执行的控制器方法需要 HTTP 动词(<code class="docutils literal notranslate"><span class="pre">get</span></code>、<code class="docutils literal notranslate"><span class="pre">post</span></code>、<code class="docutils literal notranslate"><span class="pre">put</span></code> 等)前缀,如 <code class="docutils literal notranslate"><span class="pre">getIndex()</span></code>、<code class="docutils literal notranslate"><span class="pre">postCreate()</span></code>。</p>
</div>
<p>更多信息请参阅 <a class="reference internal" href="controllers.html#controller-auto-routing-improved"><span class="std std-ref">控制器中的自动路由(改进版)</span></a>。</p>
</section>
<section id="routing-auto-routing-improved-configuration-options">
<span id="id51"></span><h3><a class="toc-backref" href="#id117" role="doc-backlink">配置选项</a><a class="headerlink" href="#routing-auto-routing-improved-configuration-options" title="此标题的永久链接"></a></h3>
<p>这些选项在 <strong>app/Config/Routing.php</strong> 文件中可用。</p>
<section id="id52">
<h4><a class="toc-backref" href="#id118" role="doc-backlink">默认控制器</a><a class="headerlink" href="#id52" title="此标题的永久链接"></a></h4>
<section id="id53">
<h5>针对网站根 URI<a class="headerlink" href="#id53" title="此标题的永久链接"></a></h5>
<p>当用户访问你站点的根目录(即 <strong>example.com</strong>)时,除非为它明确定义了路由,否则使用的控制器由 <code class="docutils literal notranslate"><span class="pre">$defaultController</span></code> 属性设置的值确定。</p>
<p>默认值为 <code class="docutils literal notranslate"><span class="pre">Home</span></code>,它与 <strong>app/Controllers/Home.php</strong> 中的控制器匹配:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">string</span> <span class="nv">$defaultController</span> <span class="o">=</span> <span class="s1">&#39;Home&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id54">
<h5>针对目录 URI<a class="headerlink" href="#id54" title="此标题的永久链接"></a></h5>
<p>默认控制器也在未找到匹配的路由且 URI 指向控制器目录中的目录时使用。例如,如果用户访问 <strong>example.com/admin</strong>,如果在 <strong>app/Controllers/Admin/Home.php</strong> 中找到了一个控制器,则会使用它。</p>
<p>更多信息请参阅 <a class="reference internal" href="controllers.html#controller-auto-routing-improved"><span class="std std-ref">控制器中的自动路由(改进版)</span></a>。</p>
</section>
</section>
<section id="routing-auto-routing-improved-default-method">
<span id="id55"></span><h4><a class="toc-backref" href="#id119" role="doc-backlink">默认方法</a><a class="headerlink" href="#routing-auto-routing-improved-default-method" title="此标题的永久链接"></a></h4>
<p>这与默认控制器设置类似,但用于在找到与 URI 匹配的控制器但不存在方法段时确定使用的默认方法。默认值为 <code class="docutils literal notranslate"><span class="pre">index</span></code>。</p>
<p>在此示例中,如果用户访问 <strong>example.com/products</strong>,且存在 <code class="docutils literal notranslate"><span class="pre">Products</span></code> 控制器,将执行 <code class="docutils literal notranslate"><span class="pre">Products::getListAll()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">string</span> <span class="nv">$defaultMethod</span> <span class="o">=</span> <span class="s1">&#39;listAll&#39;</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>你无法使用控制器的默认方法名称访问控制器。在上面的示例中,你可以访问 <strong>example.com/products</strong>,但是如果访问 <strong>example.com/products/listall</strong> 将找不到。</p>
</div>
</section>
</section>
<section id="auto-routing-improved-module-routing">
<span id="id56"></span><h3><a class="toc-backref" href="#id120" role="doc-backlink">模块路由</a><a class="headerlink" href="#auto-routing-improved-module-routing" title="此标题的永久链接"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">在 4.4.0 版本加入.</span></p>
</div>
<p>即使你使用 <a class="reference internal" href="../general/modules.html"><span class="doc">代码模块</span></a> 并将控制器放置在不同的命名空间中，你仍可以使用自动路由。</p>
<p>要路由到一个模块，必须在 <strong>app/Config/Routing.php</strong> 中设置 <code class="docutils literal notranslate"><span class="pre">$moduleRoutes</span></code> 属性:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">array</span> <span class="nv">$moduleRoutes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;blog&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Acme\Blog\Controllers&#39;</span><span class="p">,</span>
<span class="p">];</span>
</pre></div>
</div>
<p>键是模块的第一个 URI 段，值是控制器的命名空间。在上述配置中，<strong>http://localhost:8080/blog/foo/bar</strong> 将被路由到 <code class="docutils literal notranslate"><span class="pre">Acme\Blog\Controllers\Foo::getBar()</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果你定义了 <code class="docutils literal notranslate"><span class="pre">$moduleRoutes</span></code>，模块的路由将优先生效。在上面的示例中，即使你有 <code class="docutils literal notranslate"><span class="pre">App\Controllers\Blog</span></code> 控制器，<strong>http://localhost:8080/blog</strong> 也将被路由到默认控制器 <code class="docutils literal notranslate"><span class="pre">Acme\Blog\Controllers\Home</span></code>。</p>
</div>
</section>
</section>
<section id="auto-routing-legacy">
<span id="id57"></span><h2><a class="toc-backref" href="#id121" role="doc-backlink">自动路由(传统)</a><a class="headerlink" href="#auto-routing-legacy" title="此标题的永久链接"></a></h2>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>这个功能只为了向后兼容而存在。在新项目中不要使用它。即使你已经在使用它，我们也推荐你使用 <a class="reference internal" href="#auto-routing-improved"><span class="std std-ref">自动路由(改进版)</span></a> 替代。</p>
</div>
<p>自动路由(传统)是来自 CodeIgniter 3 的路由系统。它可以根据约定自动路由 HTTP 请求,并执行相应的控制器方法。</p>
<p>推荐在 <strong>app/Config/Routes.php</strong> 文件中定义所有路由,或者使用 <a class="reference internal" href="#auto-routing-improved"><span class="std std-ref">自动路由(改进版)</span></a>。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>为了防止配置错误和编码错误,我们建议你不要使用自动路由(传统)功能。很容易创建容易受攻击的应用程序,其中控制器过滤器或 CSRF 保护被绕过。</p>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>自动路由(传统)会将任何 HTTP 方法的 HTTP 请求路由到控制器方法。</p>
</div>
<section id="id58">
<h3><a class="toc-backref" href="#id122" role="doc-backlink">启用自动路由(传统)</a><a class="headerlink" href="#id58" title="此标题的永久链接"></a></h3>
<p>自 v4.2.0 起,默认禁用自动路由。</p>
<p>要使用它,你需要在 <strong>app/Config/Routing.php</strong> 中将 <code class="docutils literal notranslate"><span class="pre">$autoRoute</span></code> 选项设置为 <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">bool</span> <span class="nv">$autoRoute</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</pre></div>
</div>
<p>并且在 <strong>app/Config/Feature.php</strong> 中，将属性 <code class="docutils literal notranslate"><span class="pre">$autoRoutesImproved</span></code> 设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">bool</span> <span class="nv">$autoRoutesImproved</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id59">
<h3><a class="toc-backref" href="#id123" role="doc-backlink">URI 段(传统)</a><a class="headerlink" href="#id59" title="此标题的永久链接"></a></h3>
<p>在上面的示例中,CodeIgniter 会尝试找到一个名为 <strong>Helloworld.php</strong> 的控制器,并执行 <code class="docutils literal notranslate"><span class="pre">index()</span></code> 方法。</p>
<p>更多信息请参阅 <a class="reference internal" href="controllers.html#controller-auto-routing-legacy"><span class="std std-ref">控制器中的自动路由(传统)</span></a>。</p>
</section>
<section id="routing-auto-routing-legacy-configuration-options">
<span id="id60"></span><h3><a class="toc-backref" href="#id124" role="doc-backlink">配置选项(传统)</a><a class="headerlink" href="#routing-auto-routing-legacy-configuration-options" title="此标题的永久链接"></a></h3>
<p>这些选项在 <strong>app/Config/Routing.php</strong> 文件中可用。</p>
<section id="id61">
<h4><a class="toc-backref" href="#id125" role="doc-backlink">默认控制器(传统)</a><a class="headerlink" href="#id61" title="此标题的永久链接"></a></h4>
<section id="id62">
<h5>针对网站根 URI(传统)<a class="headerlink" href="#id62" title="此标题的永久链接"></a></h5>
<p>当用户访问你网站的根（例如，<strong>example.com</strong>）时，除非存在明确的路由，否则将根据 <code class="docutils literal notranslate"><span class="pre">$defaultController</span></code> 属性设定的值来确定要使用的控制器。</p>
<p>对于这个属性，默认值是 <code class="docutils literal notranslate"><span class="pre">Home</span></code>，它匹配在 <strong>app/Controllers/Home.php</strong> 的控制器:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nx">string</span> <span class="nv">$defaultController</span> <span class="o">=</span> <span class="s1">&#39;Home&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id63">
<h5>针对目录 URI(传统)<a class="headerlink" href="#id63" title="此标题的永久链接"></a></h5>
<p>默认控制器也在未找到匹配的路由且 URI 指向控制器目录中的目录时使用。例如,如果用户访问 <strong>example.com/admin</strong>,如果在 <strong>app/Controllers/Admin/Home.php</strong> 中找到了一个控制器,则会使用它。</p>
<p>更多信息请参阅 <a class="reference internal" href="controllers.html#controller-auto-routing-legacy"><span class="std std-ref">控制器中的自动路由(传统)</span></a>。</p>
</section>
</section>
<section id="routing-auto-routing-legacy-default-method">
<span id="id64"></span><h4><a class="toc-backref" href="#id126" role="doc-backlink">默认方法(传统)</a><a class="headerlink" href="#routing-auto-routing-legacy-default-method" title="此标题的永久链接"></a></h4>
<p>这与默认控制器设置类似,但用于在找到与 URI 匹配的控制器但不存在方法段时确定使用的默认方法。默认值为 <code class="docutils literal notranslate"><span class="pre">index</span></code>。</p>
<p>在此示例中,如果用户访问 <strong>example.com/products</strong>,且存在 <code class="docutils literal notranslate"><span class="pre">Products</span></code> 控制器,将执行 <code class="docutils literal notranslate"><span class="pre">Products::listAll()</span></code> 方法:</p>
<blockquote>
<div><p>public string $defaultMethod = ‘listAll’;</p>
</div></blockquote>
</section>
</section>
</section>
<section id="id65">
<h2><a class="toc-backref" href="#id127" role="doc-backlink">确认路由</a><a class="headerlink" href="#id65" title="此标题的永久链接"></a></h2>
<p>CodeIgniter 有以下 <a class="reference internal" href="../cli/spark_commands.html"><span class="doc">命令</span></a> 可显示所有路由。</p>
<section id="spark">
<span id="routing-spark-routes"></span><h3><a class="toc-backref" href="#id128" role="doc-backlink">spark 路由</a><a class="headerlink" href="#spark" title="此标题的永久链接"></a></h3>
<p>显示所有路由和过滤器:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">php spark routes</span>
</pre></div>
</div>
<p>输出类似以下内容:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------+---------+---------------+-------------------------------+----------------+---------------+
| Method  | Route   | Name          | Handler                       | Before Filters | After Filters |
+---------+---------+---------------+-------------------------------+----------------+---------------+
| GET     | /       | »             | \App\Controllers\Home::index  |                | toolbar       |
| GET     | feed    | »             | (Closure)                     |                | toolbar       |
+---------+---------+---------------+-------------------------------+----------------+---------------+
</pre></div>
</div>
<p><em>Method</em> 列显示路由监听的 HTTP 方法。</p>
<p><em>Route</em> 列显示要匹配的路由路径。定义路由的路由以正则表达式表示。</p>
<p>自 v4.3.0 起, <em>Name</em> 列显示路由名称。<code class="docutils literal notranslate"><span class="pre">»</span></code> 表示名称与路由路径相同。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>系统并非完美。对于包含如 <code class="docutils literal notranslate"><span class="pre">([^/]+)</span></code> 或 <code class="docutils literal notranslate"><span class="pre">{locale}</span></code> 的正则表达式模式的路由，显示的 <em>Filters</em> 可能不正确（如果你在 <strong>app/Config/Filters.php</strong> 中为过滤器设置了复杂的 URI 模式），或者它显示为 <code class="docutils literal notranslate"><span class="pre">&lt;unknown&gt;</span></code>。</p>
<p><a class="reference internal" href="filters.html#spark-filter-check"><span class="std std-ref">spark filter:check</span></a> 命令可以用来检查 100% 准确的过滤器。</p>
</div>
<section id="id66">
<h4><a class="toc-backref" href="#id129" role="doc-backlink">自动路由(改进版)</a><a class="headerlink" href="#id66" title="此标题的永久链接"></a></h4>
<p>当你使用自动路由(改进版)时,输出类似以下内容:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+-----------+-------------------------+---------------+-----------------------------------+----------------+---------------+
| Method    | Route                   | Name          | Handler                           | Before Filters | After Filters |
+-----------+-------------------------+---------------+-----------------------------------+----------------+---------------+
| GET(auto) | product/list/../..[/..] |               | \App\Controllers\Product::getList |                | toolbar       |
+-----------+-------------------------+---------------+-----------------------------------+----------------+---------------+
</pre></div>
</div>
<p><em>Method</em> 将显示为 <code class="docutils literal notranslate"><span class="pre">GET(auto)</span></code>。</p>
<p><em>Route</em> 列中的 <code class="docutils literal notranslate"><span class="pre">/..</span></code> 表示一个段。<code class="docutils literal notranslate"><span class="pre">[/..]</span></code> 表示可选。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当启用自动路由并且你有 <code class="docutils literal notranslate"><span class="pre">home</span></code> 路由时,它也可以通过 <code class="docutils literal notranslate"><span class="pre">Home</span></code> 访问,或者通过 <code class="docutils literal notranslate"><span class="pre">hOme</span></code>、<code class="docutils literal notranslate"><span class="pre">hoMe</span></code>、<code class="docutils literal notranslate"><span class="pre">HOME</span></code> 等访问,但是该命令只会显示 <code class="docutils literal notranslate"><span class="pre">home</span></code>。</p>
</div>
<p>如果你看到以 <code class="docutils literal notranslate"><span class="pre">x</span></code> 开头的路由,如下所示,这表示一个无效路由,不会路由,但是控制器有公共方法进行路由。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+-----------+----------------+------+-------------------------------------+----------------+---------------+
| Method    | Route          | Name | Handler                             | Before Filters | After Filters |
+-----------+----------------+------+-------------------------------------+----------------+---------------+
| GET(auto) | x home/foo     |      | \App\Controllers\Home::getFoo       | &lt;unknown&gt;      | &lt;unknown&gt;     |
+-----------+----------------+------+-------------------------------------+----------------+---------------+
</pre></div>
</div>
<p>上面的示例显示你有 <code class="docutils literal notranslate"><span class="pre">\App\Controllers\Home::getFoo()</span></code> 方法,但是它没有路由,因为它是默认控制器(默认为 <code class="docutils literal notranslate"><span class="pre">Home</span></code>),默认控制器名称必须在 URI 中省略。你应该删除 <code class="docutils literal notranslate"><span class="pre">getFoo()</span></code> 方法。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在 v4.3.4 之前,由于一个错误,无效路由会显示为正常路由。</p>
</div>
</section>
<section id="id67">
<h4><a class="toc-backref" href="#id130" role="doc-backlink">自动路由(传统)</a><a class="headerlink" href="#id67" title="此标题的永久链接"></a></h4>
<p>当你使用自动路由(传统)时,输出类似以下内容:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+--------+--------------------+---------------+-----------------------------------+----------------+---------------+
| Method | Route              | Name          | Handler                           | Before Filters | After Filters |
+--------+--------------------+---------------+-----------------------------------+----------------+---------------+
| auto   | product/list[/...] |               | \App\Controllers\Product::getList |                | toolbar       |
+--------+--------------------+---------------+-----------------------------------+----------------+---------------+
</pre></div>
</div>
<p><em>Method</em> 将显示为 <code class="docutils literal notranslate"><span class="pre">auto</span></code>。</p>
<p><em>Route</em> 列中的 <code class="docutils literal notranslate"><span class="pre">[/...]</span></code> 表示任意数量的段。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当启用自动路由并且你有 <code class="docutils literal notranslate"><span class="pre">home</span></code> 路由时,它也可以通过 <code class="docutils literal notranslate"><span class="pre">Home</span></code> 访问,或者通过 <code class="docutils literal notranslate"><span class="pre">hOme</span></code>、<code class="docutils literal notranslate"><span class="pre">hoMe</span></code>、<code class="docutils literal notranslate"><span class="pre">HOME</span></code> 等访问,但是该命令只会显示 <code class="docutils literal notranslate"><span class="pre">home</span></code>。</p>
</div>
</section>
<section id="routing-spark-routes-sort-by-handler">
<span id="id68"></span><h4><a class="toc-backref" href="#id131" role="doc-backlink">按处理程序排序</a><a class="headerlink" href="#routing-spark-routes-sort-by-handler" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>你可以按 <em>Handler</em> 对路由进行排序:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">php spark routes -h</span>
</pre></div>
</div>
</section>
<section id="routing-spark-routes-specify-host">
<span id="id69"></span><h4><a class="toc-backref" href="#id132" role="doc-backlink">指定主机</a><a class="headerlink" href="#routing-spark-routes-specify-host" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.4.0 版本加入.</span></p>
</div>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">--host</span></code> 选项在请求 URL 中指定主机：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">php spark routes --host accounts.example.com</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="index.html" class="btn btn-neutral float-left" title="控制器和路由" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="controllers.html" class="btn btn-neutral float-right" title="控制器" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2019-2024 CodeIgniter 基金会.
      <span class="lastupdated">最后更新于 2024-05-30.
      </span></p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
  
<jinja2.runtime.BlockReference object at 0x7f2cefd31ed0>

<div style="margin-top: 16px;">
  <p>由 <a href="https://codeigniter.org.cn">CodeIgniter 中国开发者社区</a>翻译并制作</p>
  <p style="margin-bottom: 0;">
    <a href="https://github.com/CodeIgniter-Chinese/codeigniter4-user-guide" target="_blank">Github 简体中文翻译</a>
    ·
    <a href="https://codeigniter-chinese.github.io/codeigniter4-user-guide/codeigniter_user_guide.zip">离线版压缩包下载</a>
    ·
    <a href="https://codeigniter-chinese.github.io/codeigniter4-user-guide/CodeIgniter.pdf">PDF 版下载</a>
  </p>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>