<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>查询构建器类 &mdash; CodeIgniter 4.5.3 中文手册|用户手册|用户指南|中文文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme_dark.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="../_static/js/citheme.js"></script>
        <script src="../_static/js/carbon.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="事务" href="transactions.html" />
    <link rel="prev" title="查询辅助方法" href="helpers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/ci-logo-text.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">欢迎使用 CodeIgniter4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/index.html">欢迎使用 CodeIgniter4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/requirements.html">服务器需求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/credits.html">致谢</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">PSR 兼容性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">许可协议</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">安装</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Composer 安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">手动安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">运行你的应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">故障排除</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/deployment.html">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">变更记录</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">从前一版本升级</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">CodeIgniter 仓库</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">构建你的第一个应用程序</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">静态页面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">新闻部分</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">创建新闻</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">结束语</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">CodeIgniter4 概览</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">应用程序结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">模型、视图和控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">自动加载文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">工厂</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">处理 HTTP 请求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">安全指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/goals.html">设计与架构目标</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">常规主题</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">CodeIgniter URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">全局函数和常量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">记录信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">错误处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">网页缓存</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">AJAX 请求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">代码模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">管理应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">处理多个环境</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../incoming/index.html">控制器和路由</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../incoming/routing.html">URI 路由</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/controllers.html">控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/filters.html">控制器过滤器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/message.html">HTTP 消息</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/request.html">请求类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/incomingrequest.html">IncomingRequest 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/content_negotiation.html">内容协商</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/methodspoofing.html">HTTP 方法欺骗</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/restful.html">RESTful 资源处理</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">构建响应</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">视图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">视图渲染器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">视图布局</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">视图单元</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">视图解析器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">视图装饰器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">HTML 表格类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP 响应</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">API 响应特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">内容安全策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">本地化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">在视图文件中使用 PHP 替代语法</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">使用数据库</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="examples.html">快速入门:使用示例</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">数据库配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="connecting.html">连接数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="queries.html">运行查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="results.html">生成查询结果</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html">查询辅助方法</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">查询构建器类</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">事务</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html">获取元数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="call_function.html">自定义函数调用</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">数据库事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">数据库实用工具</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">数据建模</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">使用 CodeIgniter 的 Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">使用实体类</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">管理数据库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">数据库 Forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">数据库迁移</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">数据库填充</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">数据库命令</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">类库参考</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../libraries/caching.html">缓存驱动</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cookies.html">Cookie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/cors.html">跨域资源共享 (CORS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/curlrequest.html">CURLRequest 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/email.html">Email 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/encryption.html">加密服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/files.html">处理文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/file_collections.html">文件集合</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/honeypot.html">蜜罐类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/images.html">图像处理类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/pagination.html">分页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/publisher.html">Publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/sessions.html">Session 库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/throttler.html">限速器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/time.html">时间和日期</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/typography.html">排版</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uploaded_files.html">处理上传的文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/uri.html">使用 URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/user_agent.html">User Agent 类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libraries/validation.html">验证</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">辅助函数</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../helpers/array_helper.html">数组辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/cookie_helper.html">Cookie 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/date_helper.html">日期辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/filesystem_helper.html">文件系统辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/form_helper.html">表单辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/html_helper.html">HTML 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/inflector_helper.html">Inflector 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/number_helper.html">数字辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/security_helper.html">安全辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/test_helper.html">测试辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/text_helper.html">文本辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/url_helper.html">URL 辅助函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/xml_helper.html">XML 辅助函数</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">入门指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">生成数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">测试控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP 测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">测试响应</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/cli.html">测试 CLI 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">模拟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">基准测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">调试应用程序</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">命令行使用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">CLI 概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">通过 CLI 运行控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Spark 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">创建 Spark 命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">CLI 生成器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI 库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">CLIRequest 类</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">扩展 CodeIgniter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">创建核心系统类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">替换通用函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">扩展控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">身份验证</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">创建 Composer 包</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">为 CodeIgniter 做贡献</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libraries/official_packages.html">官方包</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodeIgniter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">使用数据库</a></li>
      <li class="breadcrumb-item active">查询构建器类</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>查询构建器类<a class="headerlink" href="#id1" title="此标题的永久链接"></a></h1>
<p>CodeIgniter 为你提供了查询构建器类的访问。这种模式允许你使用最小的脚本就可以在数据库中检索、插入和更新信息。在某些情况下,只需要一行或两行代码就可以执行数据库操作。
CodeIgniter 不要求每个数据库表都有自己的类文件。它提供了一个更简化的接口。</p>
<p>除了简单性之外,使用查询构建器功能的一个主要好处是,它允许你创建数据库独立的应用程序,因为查询语法是由每个数据库适配器生成的。它也允许进行更安全的查询,因为系统会自动对值进行转义。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>CodeIgniter 不支持在表名和列名中使用点（<code class="docutils literal notranslate"><span class="pre">.</span></code>）。自 v4.5.0 起，支持带点的数据库名称。</p>
</div>
<nav class="contents local" id="id2">
<ul class="simple">
<li><p><a class="reference internal" href="#sql" id="id40">SQL 注入保护</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id41">加载查询构建器</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id42">选择数据</a></p>
<ul>
<li><p><a class="reference internal" href="#get" id="id43">Get</a></p></li>
<li><p><a class="reference internal" href="#select" id="id44">Select</a></p></li>
<li><p><a class="reference internal" href="#from" id="id45">From</a></p></li>
<li><p><a class="reference internal" href="#query-builder-from-subquery" id="id46">子查询</a></p></li>
<li><p><a class="reference internal" href="#join" id="id47">Join</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id7" id="id48">查找特定数据</a></p>
<ul>
<li><p><a class="reference internal" href="#where" id="id49">Where</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id14" id="id50">查找类似数据</a></p>
<ul>
<li><p><a class="reference internal" href="#like" id="id51">Like</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id20" id="id52">排序结果</a></p>
<ul>
<li><p><a class="reference internal" href="#orderby" id="id53">OrderBy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id21" id="id54">限制或计数结果</a></p>
<ul>
<li><p><a class="reference internal" href="#limit" id="id55">Limit</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#query-builder-union" id="id56">联合查询</a></p>
<ul>
<li><p><a class="reference internal" href="#union" id="id57">Union</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id23" id="id58">分组查询</a></p>
<ul>
<li><p><a class="reference internal" href="#group" id="id59">Group</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id24" id="id60">插入数据</a></p>
<ul>
<li><p><a class="reference internal" href="#insert" id="id61">Insert</a></p></li>
<li><p><a class="reference internal" href="#insertbatch" id="id62">insertBatch</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#upsert-data" id="id63">插入更新数据</a></p>
<ul>
<li><p><a class="reference internal" href="#upsert" id="id64">Upsert</a></p></li>
<li><p><a class="reference internal" href="#upsertbatch" id="id65">upsertBatch</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id30" id="id66">更新数据</a></p>
<ul>
<li><p><a class="reference internal" href="#update" id="id67">Update</a></p></li>
<li><p><a class="reference internal" href="#updatebatch" id="id68">UpdateBatch</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id33" id="id69">删除数据</a></p>
<ul>
<li><p><a class="reference internal" href="#delete" id="id70">Delete</a></p></li>
<li><p><a class="reference internal" href="#deletebatch" id="id71">DeleteBatch</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id36" id="id72">条件语句</a></p>
<ul>
<li><p><a class="reference internal" href="#when" id="id73">When</a></p></li>
<li><p><a class="reference internal" href="#whennot" id="id74">WhenNot</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id37" id="id75">方法链</a></p></li>
<li><p><a class="reference internal" href="#ar-caching" id="id76">重置查询构建器</a></p>
<ul>
<li><p><a class="reference internal" href="#resetquery" id="id77">ResetQuery</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#namespace-CodeIgniter\Database" id="id78">类参考</a></p></li>
</ul>
</nav>
<section id="sql">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">SQL 注入保护</a><a class="headerlink" href="#sql" title="此标题的永久链接"></a></h2>
<p>你可以使用查询构建器相当安全地生成 SQL 语句。但是,它不旨在防止无论你传递什么数据都防止 SQL 注入。</p>
<dl class="simple">
<dt>传递给查询构建器的参数可以是:</dt><dd><ol class="arabic simple">
<li><p><strong>标识符</strong>,如字段(或表)名称</p></li>
<li><p>它们的 <strong>值</strong></p></li>
<li><p><strong>SQL 字符串</strong> 的一部分</p></li>
</ol>
</dd>
</dl>
<p>查询构建器默认会转义所有 <strong>值</strong>。</p>
<p>它还将尝试通过默认正确保护 <strong>标识符</strong> 和 <strong>SQL 字符串</strong> 中的标识符。
但是,它的实现是为了在许多使用案例中工作良好,而不是旨在防止所有攻击。
因此,在没有适当验证的情况下,永远不要向它们馈送用户输入。</p>
<p>此外,许多方法都有 <code class="docutils literal notranslate"><span class="pre">$escape</span></code> 参数,可以设置为禁用转义。
如果将 <code class="docutils literal notranslate"><span class="pre">$escape</span></code> 设置为 false,查询构建器不提供任何保护,
所以你必须确保在将其传递给查询构建器之前已经适当地对它们进行了转义或保护。
使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 指定原始 SQL 语句时也是如此。</p>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id41" role="doc-backlink">加载查询构建器</a><a class="headerlink" href="#id3" title="此标题的永久链接"></a></h2>
<p>可以通过数据库连接上的 <code class="docutils literal notranslate"><span class="pre">table()</span></code> 方法加载查询构建器。这会为你设置查询的 <strong>FROM</strong> 部分,并返回查询构建器类的新实例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$db</span>      <span class="o">=</span> <span class="nx">\Config\Database</span><span class="o">::</span><span class="na">connect</span><span class="p">();</span>
<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>只有在明确请求类时,才会将查询构建器加载到内存中,因此默认情况下不使用任何资源。</p>
</section>
<section id="id4">
<h2><a class="toc-backref" href="#id42" role="doc-backlink">选择数据</a><a class="headerlink" href="#id4" title="此标题的永久链接"></a></h2>
<p>以下方法允许你构建 SQL <strong>SELECT</strong> 语句。</p>
<section id="get">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Get</a><a class="headerlink" href="#get" title="此标题的永久链接"></a></h3>
<section id="builder-get">
<h4>$builder-&gt;get()<a class="headerlink" href="#builder-get" title="此标题的永久链接"></a></h4>
<p>运行选择查询并返回结果。可以自己使用以从表中检索所有记录:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;mytable&#39;</span><span class="p">);</span>
<span class="nv">$query</span>   <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>  <span class="c1">// Produces: SELECT * FROM mytable</span>
</pre></div>
</div>
<p>第一个和第二个参数使你可以设置 limit 和 offset 子句:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Executes: SELECT * FROM mytable LIMIT 20, 10</span>
<span class="cm"> * (in MySQL. Other databases have slightly different syntax)</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>你会注意到上面的方法被赋值给一个名为 $query 的变量,可用于显示结果:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$query</span><span class="o">-&gt;</span><span class="na">getResult</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$row</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>有关结果生成的完整讨论,请访问 <a class="reference internal" href="results.html#getresult"><span class="std std-ref">getResult()</span></a> 方法页面。</p>
<p>请访问 <a class="reference internal" href="results.html#getresult"><span class="std std-ref">getResult()</span></a> 方法，以了解关于结果生成的完整讨论。</p>
</section>
<section id="builder-getcompiledselect">
<h4>$builder-&gt;getCompiledSelect()<a class="headerlink" href="#builder-getcompiledselect" title="此标题的永久链接"></a></h4>
<p>编译选择查询,就像 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;get()</span></code> 一样,但不运行查询。此方法简单地将 SQL 查询作为字符串返回。</p>
<p>例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">getCompiledSelect</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$sql</span><span class="p">;</span>
<span class="c1">// Prints string: SELECT * FROM mytable</span>
</pre></div>
</div>
<p>下面第一个查询中的参数 (false) 允许你设置查询构建器是否会被重置（因为该参数的默认值为 true，即默认情况下 <code class="docutils literal notranslate"><span class="pre">getCompiledSelect(bool</span> <span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true)</span></code> 会像使用 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;get()</span></code> 一样被重置）：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledSelect</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Prints string: SELECT * FROM mytable LIMIT 20, 10</span>
<span class="cm"> * (in MySQL. Other databases have slightly different syntax)</span>
<span class="cm"> */</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;title, content, date&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledSelect</span><span class="p">();</span>
<span class="c1">// Prints string: SELECT title, content, date FROM mytable LIMIT 20, 10</span>
</pre></div>
</div>
<p>在上述示例中需要注意的关键点是，第二个查询并没有使用 <code class="docutils literal notranslate"><span class="pre">limit(10,</span> <span class="pre">20)</span></code>，但生成的 SQL 查询却包含 <code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">20,</span> <span class="pre">10</span></code>。这种结果的原因是因为第一个查询中的参数被设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>，因此 <code class="docutils literal notranslate"><span class="pre">limit(10,</span> <span class="pre">20)</span></code> 在第二个查询中仍然有效。</p>
</section>
<section id="builder-getwhere">
<h4>$builder-&gt;getWhere()<a class="headerlink" href="#builder-getwhere" title="此标题的永久链接"></a></h4>
<p>与 <code class="docutils literal notranslate"><span class="pre">get()</span></code> 方法相同,只是它允许你在第一个参数中添加 “where” 子句,而不是使用 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;where()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">getWhere</span><span class="p">([</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">],</span> <span class="nv">$limit</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">);</span>
</pre></div>
</div>
<p>请阅读下面关于 <code class="docutils literal notranslate"><span class="pre">where()</span></code> 方法的更多信息。</p>
</section>
</section>
<section id="select">
<span id="query-builder-select"></span><h3><a class="toc-backref" href="#id44" role="doc-backlink">Select</a><a class="headerlink" href="#select" title="此标题的永久链接"></a></h3>
<section id="builder-select">
<h4>$builder-&gt;select()<a class="headerlink" href="#builder-select" title="此标题的永久链接"></a></h4>
<p>允许你编写查询的 <strong>SELECT</strong> 部分:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;title, content, date&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Executes: SELECT title, content, date FROM mytable</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果从表中选择所有 (<code class="docutils literal notranslate"><span class="pre">*</span></code>),则不需要使用此方法。如果省略,CodeIgniter 会假定你希望选择所有字段并自动添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code>。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">$builder-&gt;select()</span></code> 接受一个可选的第二个参数。如果将其设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>,CodeIgniter 将不会尝试保护你的字段或表名。这在需要复合 select 语句的情况下很有用,其中自动转义字段可能会破坏它们。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;(SELECT SUM(payments.amount) FROM payments WHERE payments.invoice_id=4) AS amount_paid&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
<section id="rawsql">
<span id="query-builder-select-rawsql"></span><h5>RawSql<a class="headerlink" href="#rawsql" title="此标题的永久链接"></a></h5>
<div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>从 v4.2.0 开始, <code class="docutils literal notranslate"><span class="pre">$builder-&gt;select()</span></code> 接受一个 <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Database\RawSql</span></code> 实例,它表示原始 SQL 字符串。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;REGEXP_SUBSTR(ral_anno,&quot;[0-9]{1,2}([,.][0-9]{1,3})([,.][0-9]{1,3})&quot;) AS ral&#39;</span><span class="p">;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="nv">$sql</span><span class="p">));</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对值和标识符进行转义。否则可能会导致 SQL 注入。</p>
</div>
</section>
</section>
<section id="builder-selectmax">
<h4>$builder-&gt;selectMax()<a class="headerlink" href="#builder-selectmax" title="此标题的永久链接"></a></h4>
<p>为查询编写一个 <strong>SELECT MAX(field)</strong> 部分。你可以选择包括第二个参数以重命名结果字段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectMax</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT MAX(age) as age FROM mytable</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectMax</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;member_age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT MAX(age) as member_age FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-selectmin">
<h4>$builder-&gt;selectMin()<a class="headerlink" href="#builder-selectmin" title="此标题的永久链接"></a></h4>
<p>为查询编写一个 <strong>SELECT MIN(field)</strong> 部分。与 <code class="docutils literal notranslate"><span class="pre">selectMax()</span></code> 一样,你可以选择包括第二个参数以重命名结果字段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectMin</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT MIN(age) as age FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-selectavg">
<h4>$builder-&gt;selectAvg()<a class="headerlink" href="#builder-selectavg" title="此标题的永久链接"></a></h4>
<p>为查询编写一个 <strong>SELECT AVG(field)</strong> 部分。与 <code class="docutils literal notranslate"><span class="pre">selectMax()</span></code> 一样,你可以选择包括第二个参数以重命名结果字段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectAvg</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT AVG(age) as age FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-selectsum">
<h4>$builder-&gt;selectSum()<a class="headerlink" href="#builder-selectsum" title="此标题的永久链接"></a></h4>
<p>为查询编写一个 <strong>SELECT SUM(field)</strong> 部分。与 <code class="docutils literal notranslate"><span class="pre">selectMax()</span></code> 一样,你可以选择包括第二个参数以重命名结果字段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectSum</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT SUM(age) as age FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-selectcount">
<h4>$builder-&gt;selectCount()<a class="headerlink" href="#builder-selectcount" title="此标题的永久链接"></a></h4>
<p>为查询编写一个 <strong>SELECT COUNT(field)</strong> 部分。与 <code class="docutils literal notranslate"><span class="pre">selectMax()</span></code> 一样,你可以选择包括第二个参数以重命名结果字段。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法与 <code class="docutils literal notranslate"><span class="pre">groupBy()</span></code> 一起使用时特别有用。有关计数结果的更多信息,请参阅 <code class="docutils literal notranslate"><span class="pre">countAll()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">countAllResults()</span></code>。</p>
</div>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">selectCount</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT COUNT(age) as age FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-selectsubquery">
<h4>$builder-&gt;selectSubquery()<a class="headerlink" href="#builder-selectsubquery" title="此标题的永久链接"></a></h4>
<p>在 SELECT 部分添加子查询。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$subquery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;countries&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nv">$builder</span>  <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">selectSubquery</span><span class="p">(</span><span class="nv">$subquery</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">);</span>
<span class="nv">$query</span>    <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT `name`, (SELECT `name` FROM `countries` WHERE `id` = 1) `country` FROM `users`</span>
</pre></div>
</div>
</section>
</section>
<section id="from">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">From</a><a class="headerlink" href="#from" title="此标题的永久链接"></a></h3>
<section id="builder-from">
<h4>$builder-&gt;from()<a class="headerlink" href="#builder-from" title="此标题的永久链接"></a></h4>
<p>允许你编写查询的 <strong>FROM</strong> 部分:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;title, content, date&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;mytable&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT title, content, date FROM users, mytable</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如前所示,可以在 <code class="docutils literal notranslate"><span class="pre">$db-&gt;table()</span></code> 方法中指定 <strong>FROM</strong> 部分。对 from() 的额外调用将向 FROM 部分添加更多表。</p>
</div>
</section>
</section>
<section id="query-builder-from-subquery">
<span id="id5"></span><h3><a class="toc-backref" href="#id46" role="doc-backlink">子查询</a><a class="headerlink" href="#query-builder-from-subquery" title="此标题的永久链接"></a></h3>
<section id="builder-fromsubquery">
<h4>$builder-&gt;fromSubquery()<a class="headerlink" href="#builder-fromsubquery" title="此标题的永久链接"></a></h4>
<p>允许你将 <strong>FROM</strong> 查询的一部分编写为子查询。</p>
<p>这是我们将子查询添加到现有表的地方:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$subquery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">);</span>
<span class="nv">$builder</span>  <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">fromSubquery</span><span class="p">(</span><span class="nv">$subquery</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">);</span>
<span class="nv">$query</span>    <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT * FROM `jobs`, (SELECT * FROM `users`) `alias`</span>
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">$db-&gt;newQuery()</span></code> 方法将子查询设置为主表:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$subquery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id, name&#39;</span><span class="p">);</span>
<span class="nv">$builder</span>  <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">newQuery</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">fromSubquery</span><span class="p">(</span><span class="nv">$subquery</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">);</span>
<span class="nv">$query</span>    <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT * FROM (SELECT `id`, `name` FROM users) `t`</span>
</pre></div>
</div>
</section>
</section>
<section id="join">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">Join</a><a class="headerlink" href="#join" title="此标题的永久链接"></a></h3>
<section id="builder-join">
<h4>$builder-&gt;join()<a class="headerlink" href="#builder-join" title="此标题的永久链接"></a></h4>
<p>允许你编写查询的 <strong>JOIN</strong> 部分:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;blogs&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;comments&#39;</span><span class="p">,</span> <span class="s1">&#39;comments.id = blogs.id&#39;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * SELECT * FROM blogs JOIN comments ON comments.id = blogs.id</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>如果需要在一个查询中进行多个连接,可以进行多次方法调用。</p>
<p>如果需要特定类型的 <strong>JOIN</strong>,可以通过方法的第三个参数指定。选项是:<code class="docutils literal notranslate"><span class="pre">left</span></code>、<code class="docutils literal notranslate"><span class="pre">right</span></code>、<code class="docutils literal notranslate"><span class="pre">outer</span></code>、<code class="docutils literal notranslate"><span class="pre">inner</span></code>、<code class="docutils literal notranslate"><span class="pre">left</span> <span class="pre">outer</span></code> 和 <code class="docutils literal notranslate"><span class="pre">right</span> <span class="pre">outer</span></code>。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;comments&#39;</span><span class="p">,</span> <span class="s1">&#39;comments.id = blogs.id&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">);</span>
<span class="c1">// Produces: LEFT JOIN comments ON comments.id = blogs.id</span>
</pre></div>
</div>
<section id="query-builder-join-rawsql">
<span id="id6"></span><h5>RawSql<a class="headerlink" href="#query-builder-join-rawsql" title="此标题的永久链接"></a></h5>
<div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>从 v4.2.0 开始, <code class="docutils literal notranslate"><span class="pre">$builder-&gt;join()</span></code> 接受一个 <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Database\RawSql</span></code> 实例,它表示原始 SQL 字符串。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;user.id = device.user_id AND ((1=1 OR 1=1) OR (1=1 OR 1=1))&#39;</span><span class="p">;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="nv">$sql</span><span class="p">),</span> <span class="s1">&#39;LEFT&#39;</span><span class="p">);</span>
<span class="c1">// Produces: LEFT JOIN &quot;user&quot; ON user.id = device.user_id AND ((1=1 OR 1=1) OR (1=1 OR 1=1))</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对值和标识符进行转义。否则可能会导致 SQL 注入。</p>
</div>
</section>
</section>
</section>
</section>
<section id="id7">
<h2><a class="toc-backref" href="#id48" role="doc-backlink">查找特定数据</a><a class="headerlink" href="#id7" title="此标题的永久链接"></a></h2>
<section id="where">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">Where</a><a class="headerlink" href="#where" title="此标题的永久链接"></a></h3>
<section id="builder-where">
<h4>$builder-&gt;where()<a class="headerlink" href="#builder-where" title="此标题的永久链接"></a></h4>
<p>此方法使用五种方法之一启用设置 <strong>WHERE</strong> 子句:</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除了使用自定义字符串外,传递给此方法的所有值都会自动转义,生成更安全的查询。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">$builder-&gt;where()</span></code> 接受一个可选的第三个参数。如果将其设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>,CodeIgniter 将不会尝试保护你的字段或表名。</p>
</div>
<section id="id8">
<h5>1. 简单的键/值方法<a class="headerlink" href="#id8" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="c1">// Produces: WHERE name = &#39;Joe&#39;</span>
</pre></div>
</div>
<p>请注意等号是自动添加的。</p>
<p>如果使用多个方法调用,它们将在它们之间用 <strong>AND</strong> 链在一起:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="nv">$title</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="nv">$status</span><span class="p">);</span>
<span class="c1">// WHERE name = &#39;Joe&#39; AND title = &#39;boss&#39; AND status = &#39;active&#39;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id9">
<h5>2. 自定义键/值方法<a class="headerlink" href="#id9" title="此标题的永久链接"></a></h5>
<blockquote>
<div><p>你可以在第一个参数中包含一个运算符来控制比较:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;name !=&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id &lt;&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
<span class="c1">// Produces: WHERE name != &#39;Joe&#39; AND id &lt; 45</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id10">
<h5>3. 关联数组方法<a class="headerlink" href="#id10" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nv">$title</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nv">$status</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="c1">// Produces: WHERE name = &#39;Joe&#39; AND title = &#39;boss&#39; AND status = &#39;active&#39;</span>
</pre></div>
</div>
<p>使用此方法也可以包含自己的运算符:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name !=&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span> <span class="s1">&#39;id &lt;&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">&#39;date &gt;&#39;</span> <span class="o">=&gt;</span> <span class="nv">$date</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id11">
<h5>4. 自定义字符串<a class="headerlink" href="#id11" title="此标题的永久链接"></a></h5>
<blockquote>
<div><p>你可以手动编写自己的子句:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$where</span> <span class="o">=</span> <span class="s2">&quot;name=&#39;Joe&#39; AND status=&#39;boss&#39; OR status=&#39;active&#39;&quot;</span><span class="p">;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$where</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果在字符串中使用用户提供的数据,则必须手动对值和标识符进行转义。否则可能会导致 SQL 注入。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$name</span>  <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="s1">&#39;Joe&#39;</span><span class="p">);</span>
<span class="nv">$where</span> <span class="o">=</span> <span class="s2">&quot;name=</span><span class="si">{</span><span class="nv">$name</span><span class="si">}</span><span class="s2"> AND status=&#39;boss&#39; OR status=&#39;active&#39;&quot;</span><span class="p">;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$where</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div></blockquote>
</section>
<section id="query-builder-where-rawsql">
<span id="id12"></span><h5>5. RawSql<a class="headerlink" href="#query-builder-where-rawsql" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>从 v4.2.0 开始, <code class="docutils literal notranslate"><span class="pre">$builder-&gt;where()</span></code> 接受一个 <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Database\RawSql</span></code> 实例,它表示原始 SQL 字符串。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;id &gt; 2 AND name != &#39;Accountant&#39;&quot;</span><span class="p">;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="nv">$sql</span><span class="p">));</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对值和标识符进行转义。否则可能会导致 SQL 注入。</p>
</div>
</div></blockquote>
</section>
<section id="query-builder-where-subquery">
<span id="id13"></span><h5>6. 子查询<a class="headerlink" href="#query-builder-where-subquery" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;advance_amount &lt;&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;MAX(advance_amount)&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id &gt;&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: WHERE &quot;advance_amount&quot; &lt; (SELECT MAX(advance_amount) FROM &quot;orders&quot; WHERE &quot;id&quot; &gt; 2)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;MAX(advance_amount)&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id &gt;&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;advance_amount &lt;&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="builder-orwhere">
<h4>$builder-&gt;orWhere()<a class="headerlink" href="#builder-orwhere" title="此标题的永久链接"></a></h4>
<p>此方法与上面的方法相同,只是多个实例由 <strong>OR</strong> 连接:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;name !=&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhere</span><span class="p">(</span><span class="s1">&#39;id &gt;&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
<span class="c1">// Produces: WHERE name != &#39;Joe&#39; OR id &gt; 50</span>
</pre></div>
</div>
</section>
<section id="builder-wherein">
<h4>$builder-&gt;whereIn()<a class="headerlink" href="#builder-wherein" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>AND</strong> 连接的 <strong>WHERE field IN (‘item’, ‘item’)</strong> SQL 查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Todd&#39;</span><span class="p">,</span> <span class="s1">&#39;James&#39;</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereIn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nv">$names</span><span class="p">);</span>
<span class="c1">// Produces: WHERE username IN (&#39;Frank&#39;, &#39;Todd&#39;, &#39;James&#39;)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: WHERE &quot;id&quot; IN (SELECT &quot;job_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;user_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-orwherein">
<h4>$builder-&gt;orWhereIn()<a class="headerlink" href="#builder-orwherein" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>OR</strong> 连接的 <strong>WHERE field IN (‘item’, ‘item’)</strong> SQL 查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Todd&#39;</span><span class="p">,</span> <span class="s1">&#39;James&#39;</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereIn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nv">$names</span><span class="p">);</span>
<span class="c1">// Produces: OR username IN (&#39;Frank&#39;, &#39;Todd&#39;, &#39;James&#39;)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: OR &quot;id&quot; IN (SELECT &quot;job_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;user_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-wherenotin">
<h4>$builder-&gt;whereNotIn()<a class="headerlink" href="#builder-wherenotin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>AND</strong> 连接的 <strong>WHERE field NOT IN (‘item’, ‘item’)</strong> SQL 查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Todd&#39;</span><span class="p">,</span> <span class="s1">&#39;James&#39;</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereNotIn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nv">$names</span><span class="p">);</span>
<span class="c1">// Produces: WHERE username NOT IN (&#39;Frank&#39;, &#39;Todd&#39;, &#39;James&#39;)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: WHERE &quot;id&quot; NOT IN (SELECT &quot;job_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;user_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">whereNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-orwherenotin">
<h4>$builder-&gt;orWhereNotIn()<a class="headerlink" href="#builder-orwherenotin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>OR</strong> 连接的 <strong>WHERE field NOT IN (‘item’, ‘item’)</strong> SQL 查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Todd&#39;</span><span class="p">,</span> <span class="s1">&#39;James&#39;</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereNotIn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nv">$names</span><span class="p">);</span>
<span class="c1">// Produces: OR username NOT IN (&#39;Frank&#39;, &#39;Todd&#39;, &#39;James&#39;)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: OR &quot;id&quot; NOT IN (SELECT &quot;job_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;user_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;job_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orWhereNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id14">
<h2><a class="toc-backref" href="#id50" role="doc-backlink">查找类似数据</a><a class="headerlink" href="#id14" title="此标题的永久链接"></a></h2>
<section id="like">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">Like</a><a class="headerlink" href="#like" title="此标题的永久链接"></a></h3>
<section id="builder-like">
<h4>$builder-&gt;like()<a class="headerlink" href="#builder-like" title="此标题的永久链接"></a></h4>
<p>此方法使你可以生成 <strong>LIKE</strong> 子句,用于执行搜索。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>传递给此方法的所有值都会自动转义。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>可以通过向方法传递第五个参数 <code class="docutils literal notranslate"><span class="pre">true</span></code> 来强制所有 <code class="docutils literal notranslate"><span class="pre">like*</span></code> 方法变体执行不区分大小写的搜索。这将在可用的情况下使用特定于平台的功能,否则,它将强制值变为小写,即 <code class="docutils literal notranslate"><span class="pre">WHERE</span> <span class="pre">LOWER(column)</span> <span class="pre">LIKE</span> <span class="pre">'%search%'</span></code>。这可能需要为 <code class="docutils literal notranslate"><span class="pre">LOWER(column)</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">column</span></code> 创建索引才能有效。</p>
</div>
<section id="id15">
<h5>1. 简单的键/值方法<a class="headerlink" href="#id15" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// Produces: WHERE `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
<p>如果使用多个方法调用,它们将在它们之间用 <strong>AND</strong> 链在一起:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// WHERE `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39; AND  `body` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
<p>如果要控制通配符 (<strong>%</strong>) 的放置位置,可以使用可选的第三个参数。你的选项是 <code class="docutils literal notranslate"><span class="pre">before</span></code>、<code class="docutils literal notranslate"><span class="pre">after</span></code> 和 <code class="docutils literal notranslate"><span class="pre">both</span></code> (默认)。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;before&#39;</span><span class="p">);</span> <span class="c1">// Produces: WHERE `title` LIKE &#39;%match&#39; ESCAPE &#39;!&#39;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;after&#39;</span><span class="p">);</span>  <span class="c1">// Produces: WHERE `title` LIKE &#39;match%&#39; ESCAPE &#39;!&#39;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">);</span>   <span class="c1">// Produces: WHERE `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id16">
<h5>2. 关联数组方法<a class="headerlink" href="#id16" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">,</span> <span class="s1">&#39;page1&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">,</span> <span class="s1">&#39;page2&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * WHERE `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> *     AND  `page1` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> *     AND  `page2` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> */</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="query-builder-like-rawsql">
<span id="id17"></span><h5>3. RawSql<a class="headerlink" href="#query-builder-like-rawsql" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">在 4.2.0 版本加入.</span></p>
</div>
<p>从 v4.2.0 开始, <code class="docutils literal notranslate"><span class="pre">$builder-&gt;like()</span></code> 接受一个 <code class="docutils literal notranslate"><span class="pre">CodeIgniter\Database\RawSql</span></code> 实例,它表示原始 SQL 字符串。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$sql</span>    <span class="o">=</span> <span class="s2">&quot;CONCAT(users.name, &#39; &#39;, IF(users.surname IS NULL OR users.surname = &#39;&#39;, &#39;&#39;, users.surname))&quot;</span><span class="p">;</span>
<span class="nv">$rawSql</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="nv">$rawSql</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对值和标识符进行转义。否则可能会导致 SQL 注入。</p>
</div>
</div></blockquote>
</section>
</section>
<section id="builder-orlike">
<h4>$builder-&gt;orLike()<a class="headerlink" href="#builder-orlike" title="此标题的永久链接"></a></h4>
<p>此方法与上面相同,只是多个实例由 <strong>OR</strong> 连接:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orLike</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">);</span>
<span class="c1">// WHERE `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39; OR  `body` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
<section id="builder-notlike">
<h4>$builder-&gt;notLike()<a class="headerlink" href="#builder-notlike" title="此标题的永久链接"></a></h4>
<p>此方法与 <code class="docutils literal notranslate"><span class="pre">like()</span></code> 相同,只是它生成 <strong>NOT LIKE</strong> 语句:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">notLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span> <span class="c1">// WHERE `title` NOT LIKE &#39;%match% ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
<section id="builder-ornotlike">
<h4>$builder-&gt;orNotLike()<a class="headerlink" href="#builder-ornotlike" title="此标题的永久链接"></a></h4>
<p>此方法与 <code class="docutils literal notranslate"><span class="pre">notLike()</span></code> 相同,只是多个实例由 <strong>OR</strong> 连接:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orNotLike</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// WHERE `title` LIKE &#39;%match% OR  `body` NOT LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
<section id="builder-groupby">
<h4>$builder-&gt;groupBy()<a class="headerlink" href="#builder-groupby" title="此标题的永久链接"></a></h4>
<p>允许你编写查询的 <strong>GROUP BY</strong> 部分:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
<span class="c1">// Produces: GROUP BY title</span>
</pre></div>
</div>
<p>你也可以传递多个值的数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">([</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">]);</span>
<span class="c1">// Produces: GROUP BY title, date</span>
</pre></div>
</div>
</section>
<section id="builder-distinct">
<h4>$builder-&gt;distinct()<a class="headerlink" href="#builder-distinct" title="此标题的永久链接"></a></h4>
<p>向查询添加 <strong>DISTINCT</strong> 关键字</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">distinct</span><span class="p">();</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="c1">// Produces: SELECT DISTINCT * FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-having">
<h4>$builder-&gt;having()<a class="headerlink" href="#builder-having" title="此标题的永久链接"></a></h4>
<p>允许你编写查询的 <strong>HAVING</strong> 部分。有 2 种可能的语法,1 个参数或 2 个:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">(</span><span class="s1">&#39;user_id = 45&#39;</span><span class="p">);</span> <span class="c1">// Produces: HAVING user_id = 45</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span> <span class="c1">// Produces: HAVING user_id = 45</span>
</pre></div>
</div>
<p>你也可以传递多个值的数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">([</span><span class="s1">&#39;title =&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My Title&#39;</span><span class="p">,</span> <span class="s1">&#39;id &lt;&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">]);</span>
<span class="c1">// Produces: HAVING title = &#39;My Title&#39;, id &lt; 45</span>
</pre></div>
</div>
<p>如果你使用转义值的数据库,可以通过传递可选的第三个参数并将其设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code> 来防止转义内容。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span> <span class="c1">// Produces: HAVING `user_id` = 45 in some databases such as MySQL</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span> <span class="c1">// Produces: HAVING user_id = 45</span>
</pre></div>
</div>
</section>
<section id="builder-orhaving">
<h4>$builder-&gt;orHaving()<a class="headerlink" href="#builder-orhaving" title="此标题的永久链接"></a></h4>
<p>与 <code class="docutils literal notranslate"><span class="pre">having()</span></code> 相同,只是使用 <strong>OR</strong> 分隔多个子句。</p>
</section>
<section id="builder-havingin">
<h4>$builder-&gt;havingIn()<a class="headerlink" href="#builder-havingin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>AND</strong> 相连的 <strong>HAVING 字段 IN (‘item’, ‘item’)</strong> SQL查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingIn</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="nv">$groups</span><span class="p">);</span>
<span class="c1">// Produces: HAVING group_id IN (1, 2, 3)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: HAVING &quot;id&quot; IN (SELECT &quot;user_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;group_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-orhavingin">
<h4>$builder-&gt;orHavingIn()<a class="headerlink" href="#builder-orhavingin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>OR</strong> 相连的 <strong>HAVING 字段 IN (‘item’, ‘item’)</strong> SQL查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingIn</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="nv">$groups</span><span class="p">);</span>
<span class="c1">// Produces: OR group_id IN (1, 2, 3)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: OR &quot;id&quot; IN (SELECT &quot;user_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;group_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-havingnotin">
<h4>$builder-&gt;havingNotIn()<a class="headerlink" href="#builder-havingnotin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>AND</strong> 相连的 <strong>HAVING 字段 NOT IN (‘item’, ‘item’)</strong> SQL查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingNotIn</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="nv">$groups</span><span class="p">);</span>
<span class="c1">// Produces: HAVING group_id NOT IN (1, 2, 3)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: HAVING &quot;id&quot; NOT IN (SELECT &quot;user_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;group_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-orhavingnotin">
<h4>$builder-&gt;orHavingNotIn()<a class="headerlink" href="#builder-orhavingnotin" title="此标题的永久链接"></a></h4>
<p>生成一个与 <strong>OR</strong> 相连的 <strong>HAVING 字段 NOT IN (‘item’, ‘item’)</strong> SQL查询(如果适用):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingNotIn</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="nv">$groups</span><span class="p">);</span>
<span class="c1">// Produces: OR group_id NOT IN (1, 2, 3)</span>
</pre></div>
</div>
<p>你可以使用子查询而不是值数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// With closure</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Database\BaseBuilder</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nx">BaseBuilder</span> <span class="nv">$builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// Produces: OR &quot;id&quot; NOT IN (SELECT &quot;user_id&quot; FROM &quot;users_jobs&quot; WHERE &quot;group_id&quot; = 3)</span>

<span class="c1">// With builder directly</span>
<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users_jobs&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;group_id&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingNotIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$subQuery</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="builder-havinglike">
<h4>$builder-&gt;havingLike()<a class="headerlink" href="#builder-havinglike" title="此标题的永久链接"></a></h4>
<p>此方法使你可以为 <strong>HAVING</strong> 部分生成 <strong>LIKE</strong> 子句,用于执行搜索。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>传递给此方法的所有值都会自动转义。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>可以通过向方法传递第五个参数 <code class="docutils literal notranslate"><span class="pre">true</span></code> 来强制所有 <code class="docutils literal notranslate"><span class="pre">havingLike*()</span></code> 方法变体执行不区分大小写的搜索。这将在可用的情况下使用特定于平台的功能,否则,它将强制值变为小写,即 <code class="docutils literal notranslate"><span class="pre">HAVING</span> <span class="pre">LOWER(column)</span> <span class="pre">LIKE</span> <span class="pre">'%search%'</span></code>。这可能需要为 <code class="docutils literal notranslate"><span class="pre">LOWER(column)</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">column</span></code> 创建索引才能有效。</p>
</div>
<section id="id18">
<h5>1. 简单的键/值方法<a class="headerlink" href="#id18" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// Produces: HAVING `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
<p>如果使用多个方法调用,它们将在它们之间用 <strong>AND</strong> 链在一起:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// HAVING `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39; AND  `body` LIKE &#39;%match% ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
<p>如果要控制通配符 (<strong>%</strong>) 的放置位置,可以使用可选的第三个参数。你的选项是 <code class="docutils literal notranslate"><span class="pre">before</span></code>、<code class="docutils literal notranslate"><span class="pre">after</span></code> 和 <code class="docutils literal notranslate"><span class="pre">both</span></code> (默认)。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;before&#39;</span><span class="p">);</span> <span class="c1">// Produces: HAVING `title` LIKE &#39;%match&#39; ESCAPE &#39;!&#39;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;after&#39;</span><span class="p">);</span>  <span class="c1">// Produces: HAVING `title` LIKE &#39;match%&#39; ESCAPE &#39;!&#39;</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">);</span>   <span class="c1">// Produces: HAVING `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id19">
<h5>2. 关联数组方法<a class="headerlink" href="#id19" title="此标题的永久链接"></a></h5>
<blockquote>
<div><div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">,</span> <span class="s1">&#39;page1&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">,</span> <span class="s1">&#39;page2&#39;</span> <span class="o">=&gt;</span> <span class="nv">$match</span><span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> *  HAVING `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> *      AND  `page1` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> *      AND  `page2` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
<span class="cm"> */</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="builder-orhavinglike">
<h4>$builder-&gt;orHavingLike()<a class="headerlink" href="#builder-orhavinglike" title="此标题的永久链接"></a></h4>
<p>此方法与上面相同,只是多个实例由 <strong>OR</strong> 连接:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orHavingLike</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">);</span>
<span class="c1">// HAVING `title` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39; OR  `body` LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
<section id="builder-nothavinglike">
<h4>$builder-&gt;notHavingLike()<a class="headerlink" href="#builder-nothavinglike" title="此标题的永久链接"></a></h4>
<p>此方法与 <code class="docutils literal notranslate"><span class="pre">havingLike()</span></code> 相同,只是它生成 <strong>NOT LIKE</strong> 语句:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">notHavingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// HAVING `title` NOT LIKE &#39;%match% ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
<section id="builder-ornothavinglike">
<h4>$builder-&gt;orNotHavingLike()<a class="headerlink" href="#builder-ornothavinglike" title="此标题的永久链接"></a></h4>
<p>此方法与 <code class="docutils literal notranslate"><span class="pre">notHavingLike()</span></code> 相同,只是多个实例由 <strong>OR</strong> 连接:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">havingLike</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orNotHavingLike</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="c1">// HAVING `title` LIKE &#39;%match% OR  `body` NOT LIKE &#39;%match%&#39; ESCAPE &#39;!&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id20">
<h2><a class="toc-backref" href="#id52" role="doc-backlink">排序结果</a><a class="headerlink" href="#id20" title="此标题的永久链接"></a></h2>
<section id="orderby">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">OrderBy</a><a class="headerlink" href="#orderby" title="此标题的永久链接"></a></h3>
<section id="builder-orderby">
<h4>$builder-&gt;orderBy()<a class="headerlink" href="#builder-orderby" title="此标题的永久链接"></a></h4>
<p>允许你设置 <strong>ORDER BY</strong> 子句。</p>
<p>第一个参数包含要排序的列的名称。</p>
<p>第二个参数让你设置所请求的排序方向 - ASC、DESC 或 random。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">);</span>
<span class="c1">// Produces: ORDER BY `title` DESC</span>
</pre></div>
</div>
<p>你也可以在第一个参数中传递自己的字符串:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;title DESC, name ASC&#39;</span><span class="p">);</span>
<span class="c1">// Produces: ORDER BY `title` DESC, `name` ASC</span>
</pre></div>
</div>
<p>或者如果需要对多个字段进行排序,可以进行多次方法调用。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;ASC&#39;</span><span class="p">);</span>
<span class="c1">// Produces: ORDER BY `title` DESC, `name` ASC</span>
</pre></div>
</div>
<p>如果选择 <code class="docutils literal notranslate"><span class="pre">RANDOM</span></code> 排序方向,则首参数将被忽略,除非指定数值种子。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;RANDOM&#39;</span><span class="p">);</span>
<span class="c1">// Produces: ORDER BY RAND()</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;RANDOM&#39;</span><span class="p">);</span>
<span class="c1">// Produces: ORDER BY RAND(42)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id21">
<h2><a class="toc-backref" href="#id54" role="doc-backlink">限制或计数结果</a><a class="headerlink" href="#id21" title="此标题的永久链接"></a></h2>
<section id="limit">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">Limit</a><a class="headerlink" href="#limit" title="此标题的永久链接"></a></h3>
<section id="builder-limit">
<h4>$builder-&gt;limit()<a class="headerlink" href="#builder-limit" title="此标题的永久链接"></a></h4>
<p>允许你限制返回的行数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="c1">// Produces: LIMIT 10</span>
</pre></div>
</div>
<p>第二个参数允许你设置结果偏移量。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="c1">// Produces: LIMIT 20, 10 (in MySQL. Other databases have slightly different syntax)</span>
</pre></div>
</div>
</section>
<section id="builder-countallresults">
<h4>$builder-&gt;countAllResults()<a class="headerlink" href="#builder-countallresults" title="此标题的永久链接"></a></h4>
<p>允许你确定特定 Query Builder 查询中的行数。查询将接受 Query Builder 限制器,如 <code class="docutils literal notranslate"><span class="pre">where()</span></code>、<code class="docutils literal notranslate"><span class="pre">orWhere()</span></code>、<code class="docutils literal notranslate"><span class="pre">like()</span></code>、<code class="docutils literal notranslate"><span class="pre">orLike()</span></code> 等。例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">countAllResults</span><span class="p">();</span> <span class="c1">// Produces an integer, like 25</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">countAllResults</span><span class="p">();</span> <span class="c1">// Produces an integer, like 17</span>
</pre></div>
</div>
<p>但是,此方法也会重置你可能传递给 <code class="docutils literal notranslate"><span class="pre">select()</span></code> 的任何字段值。如果需要保留它们,可以将第一个参数设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">countAllResults</span><span class="p">(</span><span class="k">false</span><span class="p">);</span> <span class="c1">// Produces an integer, like 17</span>
</pre></div>
</div>
</section>
<section id="builder-countall">
<h4>$builder-&gt;countAll()<a class="headerlink" href="#builder-countall" title="此标题的永久链接"></a></h4>
<p>允许你确定特定表中的行数。例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">countAll</span><span class="p">();</span> <span class="c1">// Produces an integer, like 25</span>
</pre></div>
</div>
<p>与 <code class="docutils literal notranslate"><span class="pre">countAllResult()</span></code> 方法一样,此方法也会重置你可能传递给 <code class="docutils literal notranslate"><span class="pre">select()</span></code> 的任何字段值。如果需要保留它们,可以将第一个参数设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>。</p>
</section>
</section>
</section>
<section id="query-builder-union">
<span id="id22"></span><h2><a class="toc-backref" href="#id56" role="doc-backlink">联合查询</a><a class="headerlink" href="#query-builder-union" title="此标题的永久链接"></a></h2>
<section id="union">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">Union</a><a class="headerlink" href="#union" title="此标题的永久链接"></a></h3>
<section id="builder-union">
<h4>$builder-&gt;union()<a class="headerlink" href="#builder-union" title="此标题的永久链接"></a></h4>
<p>用于合并两个或多个 SELECT 语句的结果。它将只返回唯一的结果。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id, name&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="nv">$union</span>   <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;groups&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id, name&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">union</span><span class="p">(</span><span class="nv">$union</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * SELECT * FROM (SELECT `id`, `name` FROM `users` LIMIT 10) uwrp0</span>
<span class="cm"> * UNION SELECT * FROM (SELECT `id`, `name` FROM `groups`) uwrp1</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>对于正确使用某些 DBMS(如 MSSQL 和 Oracle),查询将被包装在 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">(</span> <span class="pre">...</span> <span class="pre">)</span> <span class="pre">alias</span></code> 中。
主查询总是具有 <code class="docutils literal notranslate"><span class="pre">uwrp0</span></code> 的别名。每个后续通过 <code class="docutils literal notranslate"><span class="pre">union()</span></code> 添加的查询都具有 <code class="docutils literal notranslate"><span class="pre">uwrpN+1</span></code> 的别名。</p>
</div>
<p>所有联合查询都将在主查询之后添加,而不考虑调用 <code class="docutils literal notranslate"><span class="pre">union()</span></code> 方法的顺序。也就是说, <code class="docutils literal notranslate"><span class="pre">limit()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">orderBy()</span></code> 方法将针对主查询,即使在 <code class="docutils literal notranslate"><span class="pre">union()</span></code> 之后调用。</p>
<p>在某些情况下,可能需要对查询结果进行排序或限制记录数。解决方案是使用通过 <code class="docutils literal notranslate"><span class="pre">$db-&gt;newQuery()</span></code> 创建的 wrapper。在下面的示例中,我们获取前 5 个用户 + 最后 5 个用户并按 id 排序:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$union</span>   <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id, name&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="nv">$builder</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id, name&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;ASC&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">union</span><span class="p">(</span><span class="nv">$union</span><span class="p">);</span>

<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">newQuery</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">fromSubquery</span><span class="p">(</span><span class="nv">$builder</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * SELECT * FROM (</span>
<span class="cm"> *      SELECT * FROM (SELECT `id`, `name` FROM `users` ORDER BY `id` ASC LIMIT 5) uwrp0</span>
<span class="cm"> *      UNION</span>
<span class="cm"> *      SELECT * FROM (SELECT `id`, `name` FROM `users` ORDER BY `id` DESC LIMIT 5) uwrp1</span>
<span class="cm"> * ) q ORDER BY `id` DESC</span>
<span class="cm"> */</span>
</pre></div>
</div>
</section>
<section id="builder-unionall">
<h4>$builder-&gt;unionAll()<a class="headerlink" href="#builder-unionall" title="此标题的永久链接"></a></h4>
<p>行为与 <code class="docutils literal notranslate"><span class="pre">union()</span></code> 方法相同。但是,将返回所有结果,而不仅仅是唯一的结果。</p>
</section>
</section>
</section>
<section id="id23">
<h2><a class="toc-backref" href="#id58" role="doc-backlink">分组查询</a><a class="headerlink" href="#id23" title="此标题的永久链接"></a></h2>
<section id="group">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">Group</a><a class="headerlink" href="#group" title="此标题的永久链接"></a></h3>
<p>查询分组允许你通过用括号将它们分组来创建复杂的 <strong>WHERE</strong> 子句。这将允许你创建具有复杂 <strong>WHERE</strong> 子句的查询。支持嵌套分组。例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">groupStart</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">orGroupStart</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">groupEnd</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">groupEnd</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Generates:</span>
<span class="cm"> * SELECT * FROM (`my_table`) WHERE ( `a` = &#39;a&#39; OR ( `b` = &#39;b&#39; AND `c` = &#39;c&#39; ) ) AND `d` = &#39;d&#39;</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>分组需要平衡,请确保每个 <code class="docutils literal notranslate"><span class="pre">groupStart()</span></code> 都与 <code class="docutils literal notranslate"><span class="pre">groupEnd()</span></code> 匹配。</p>
</div>
<section id="builder-groupstart">
<h4>$builder-&gt;groupStart()<a class="headerlink" href="#builder-groupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>WHERE</strong> 子句添加开括号来启动新的分组。</p>
</section>
<section id="builder-orgroupstart">
<h4>$builder-&gt;orGroupStart()<a class="headerlink" href="#builder-orgroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>WHERE</strong> 子句添加开括号并添加 <strong>OR</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-notgroupstart">
<h4>$builder-&gt;notGroupStart()<a class="headerlink" href="#builder-notgroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>WHERE</strong> 子句添加开括号并添加 <strong>NOT</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-ornotgroupstart">
<h4>$builder-&gt;orNotGroupStart()<a class="headerlink" href="#builder-ornotgroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>WHERE</strong> 子句添加开括号并添加 <strong>OR NOT</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-groupend">
<h4>$builder-&gt;groupEnd()<a class="headerlink" href="#builder-groupend" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>WHERE</strong> 子句添加闭括号来结束当前分组。</p>
</section>
<section id="builder-havinggroupstart">
<h4>$builder-&gt;havingGroupStart()<a class="headerlink" href="#builder-havinggroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>HAVING</strong> 子句添加开括号来启动新的分组。</p>
</section>
<section id="builder-orhavinggroupstart">
<h4>$builder-&gt;orHavingGroupStart()<a class="headerlink" href="#builder-orhavinggroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>HAVING</strong> 子句添加开括号并添加 <strong>OR</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-nothavinggroupstart">
<h4>$builder-&gt;notHavingGroupStart()<a class="headerlink" href="#builder-nothavinggroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>HAVING</strong> 子句添加开括号并添加 <strong>NOT</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-ornothavinggroupstart">
<h4>$builder-&gt;orNotHavingGroupStart()<a class="headerlink" href="#builder-ornothavinggroupstart" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>HAVING</strong> 子句添加开括号并添加 <strong>OR NOT</strong> 前缀来启动新的分组。</p>
</section>
<section id="builder-havinggroupend">
<h4>$builder-&gt;havingGroupEnd()<a class="headerlink" href="#builder-havinggroupend" title="此标题的永久链接"></a></h4>
<p>通过向查询的 <strong>HAVING</strong> 子句添加闭括号来结束当前分组。</p>
</section>
</section>
</section>
<section id="id24">
<h2><a class="toc-backref" href="#id60" role="doc-backlink">插入数据</a><a class="headerlink" href="#id24" title="此标题的永久链接"></a></h2>
<section id="insert">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">Insert</a><a class="headerlink" href="#insert" title="此标题的永久链接"></a></h3>
<section id="builder-insert">
<h4>$builder-&gt;insert()<a class="headerlink" href="#builder-insert" title="此标题的永久链接"></a></h4>
<p>根据你提供的数据生成 insert 字符串并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;id&#39;</span>          <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;DEFAULT&#39;</span><span class="p">),</span>
    <span class="s1">&#39;title&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;My title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;My Name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;last_update&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;CURRENT_TIMESTAMP()&#39;</span><span class="p">),</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cm">/* Produces:</span>
<span class="cm">    INSERT INTO mytable (id, title, name, date, last_update)</span>
<span class="cm">    VALUES (DEFAULT, &#39;My title&#39;, &#39;My name&#39;, &#39;2022-01-01&#39;, CURRENT_TIMESTAMP())</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>第一个参数是一个关联数组。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 外,所有值都会自动转义,生成更安全的查询。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对数据进行转义。否则可能会导致 SQL 注入。</p>
</div>
<p>这是一个使用对象的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Libraries</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$title</span>   <span class="o">=</span> <span class="s1">&#39;My Title&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s1">&#39;My Content&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$date</span>    <span class="o">=</span> <span class="s1">&#39;My Date&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">App\Libraries\MyClass</span><span class="p">;</span>

<span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nv">$object</span><span class="p">);</span>
<span class="c1">// Produces: INSERT INTO mytable (title, content, date) VALUES (&#39;My Title&#39;, &#39;My Content&#39;, &#39;My Date&#39;)</span>
</pre></div>
</div>
<p>第一个参数是一个对象。</p>
</section>
<section id="builder-ignore">
<h4>$builder-&gt;ignore()<a class="headerlink" href="#builder-ignore" title="此标题的永久链接"></a></h4>
<p>根据你提供的数据生成 insert ignore 字符串并运行查询。所以如果具有相同主键的条目已经存在,则不会插入查询。
你可以选择向方法传递一个 <strong>布尔值</strong>。也可用于 <strong>insertBatch</strong>、<strong>update</strong> 和 <strong>delete</strong> (若支持)。
下面是一个使用上述数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My Name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My date&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">ignore</span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="c1">// Produces: INSERT OR IGNORE INTO mytable (title, name, date) VALUES (&#39;My title&#39;, &#39;My name&#39;, &#39;My date&#39;)</span>
</pre></div>
</div>
</section>
<section id="builder-getcompiledinsert">
<h4>$builder-&gt;getCompiledInsert()<a class="headerlink" href="#builder-getcompiledinsert" title="此标题的永久链接"></a></h4>
<p>编译插入查询,就像 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;insert()</span></code> 一样,但不运行查询。此方法简单地将 SQL 查询作为字符串返回。</p>
<p>例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My Name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My date&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledInsert</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$sql</span><span class="p">;</span>
<span class="c1">// Produces string: INSERT INTO mytable (`title`, `name`, `date`) VALUES (&#39;My title&#39;, &#39;My name&#39;, &#39;My date&#39;)</span>
</pre></div>
</div>
<p>第一个参数使你可以设置查询构建器查询是否将重置(默认情况下,它将重置,就像 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;insert()</span></code> 一样):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;My Title&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledInsert</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
<span class="c1">// Produces string: INSERT INTO mytable (`title`) VALUES (&#39;My Title&#39;)</span>

<span class="k">echo</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;My Content&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledInsert</span><span class="p">();</span>
<span class="c1">// Produces string: INSERT INTO mytable (`title`, `content`) VALUES (&#39;My Title&#39;, &#39;My Content&#39;)</span>
</pre></div>
</div>
<p>之所以第二个查询有效,是因为第一个参数设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法不适用于批量插入。</p>
</div>
</section>
</section>
<section id="insertbatch">
<span id="insert-batch-data"></span><h3><a class="toc-backref" href="#id62" role="doc-backlink">insertBatch</a><a class="headerlink" href="#insertbatch" title="此标题的永久链接"></a></h3>
<section id="builder-insertbatch">
<h4>$builder-&gt;insertBatch()<a class="headerlink" href="#builder-insertbatch" title="此标题的永久链接"></a></h4>
<section id="id25">
<h5>通过数据插入<a class="headerlink" href="#id25" title="此标题的永久链接"></a></h5>
<p>根据你提供的数据生成 insert 字符串,并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My title&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My Name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My date&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Another title&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Another Name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Another date&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insertBatch</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * INSERT INTO mytable (title, name, date)</span>
<span class="cm"> *      VALUES (&#39;My title&#39;, &#39;My name&#39;, &#39;My date&#39;),</span>
<span class="cm"> *      (&#39;Another title&#39;, &#39;Another name&#39;, &#39;Another date&#39;)</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>第一个参数是一个关联数组。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 外,所有值都会自动转义,生成更安全的查询。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对数据进行转义。否则可能会导致 SQL 注入。</p>
</div>
</section>
<section id="id26">
<h5>通过查询插入<a class="headerlink" href="#id26" title="此标题的永久链接"></a></h5>
<p>你也可以从查询中插入:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="s1">&#39;SELECT user2.name, user2.email, user2.country</span>
<span class="s1">          FROM user2</span>
<span class="s1">          LEFT JOIN user ON user.email = user2.email</span>
<span class="s1">          WHERE user.email IS NULL&#39;</span><span class="p">;</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span>
    <span class="o">-&gt;</span><span class="na">ignore</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">setQueryAsData</span><span class="p">(</span><span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="nv">$query</span><span class="p">),</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;name, country, email&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">insertBatch</span><span class="p">();</span>
<span class="cm">/* MySQLi produces:</span>
<span class="cm">    INSERT IGNORE INTO `db_user` (`name`, `country`, `email`)</span>
<span class="cm">    SELECT user2.name, user2.email, user2.country</span>
<span class="cm">    FROM user2</span>
<span class="cm">    LEFT JOIN user ON user.email = user2.email</span>
<span class="cm">    WHERE user.email IS NULL</span>
<span class="cm">*/</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">setQueryAsData()</span></code> 可从 v4.3.0 开始使用。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>必须将选择查询的列别名为目标表的列名。</p>
</div>
</section>
</section>
</section>
</section>
<section id="upsert-data">
<span id="id27"></span><h2><a class="toc-backref" href="#id63" role="doc-backlink">插入更新数据</a><a class="headerlink" href="#upsert-data" title="此标题的永久链接"></a></h2>
<section id="upsert">
<h3><a class="toc-backref" href="#id64" role="doc-backlink">Upsert</a><a class="headerlink" href="#upsert" title="此标题的永久链接"></a></h3>
<section id="builder-upsert">
<h4>$builder-&gt;upsert()<a class="headerlink" href="#builder-upsert" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>根据你提供的数据生成插入更新字符串,并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。默认情况下,约束将按顺序定义。首先选择主键,然后是唯一键。MySQL 将默认使用任何约束。下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">upsert</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="c1">// MySQLi  produces: INSERT INTO.. ON DUPLICATE KEY UPDATE..</span>
<span class="c1">// Postgre produces: INSERT INTO.. ON CONFLICT.. DO UPDATE..</span>
<span class="c1">// SQLite3 produces: INSERT INTO.. ON CONFLICT.. DO UPDATE..</span>
<span class="c1">// SQLSRV  produces: MERGE INTO.. WHEN MATCHED THEN UPDATE.. WHEN NOT MATCHED THEN INSERT..</span>
<span class="c1">// OCI8    produces: MERGE INTO.. WHEN MATCHED THEN UPDATE.. WHEN NOT MATCHED THEN INSERT..</span>
</pre></div>
</div>
<p>第一个参数是一个关联数组。</p>
<p>这是一个使用对象的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Libraries</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$email</span>   <span class="o">=</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$name</span>    <span class="o">=</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$country</span> <span class="o">=</span> <span class="s1">&#39;Iran&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">App\Libraries\MyClass</span><span class="p">;</span>

<span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">upsert</span><span class="p">(</span><span class="nv">$object</span><span class="p">);</span>
</pre></div>
</div>
<p>第一个参数是一个对象。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>所有值都会自动转义,生成更安全的查询。</p>
</div>
</section>
<section id="builder-getcompiledupsert">
<h4>$builder-&gt;getCompiledUpsert()<a class="headerlink" href="#builder-getcompiledupsert" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>编译插入更新查询,就像 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;upsert()</span></code> 一样,但不运行查询。此方法简单地将 SQL 查询作为字符串返回。</p>
<p>例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCompiledUpsert</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$sql</span><span class="p">;</span>
<span class="cm">/* MySQLi produces:</span>
<span class="cm">    INSERT INTO `db_user` (`country`, `email`, `name`)</span>
<span class="cm">    VALUES (&#39;Iran&#39;,&#39;ahmadinejad@example.com&#39;,&#39;Ahmadinejad&#39;)</span>
<span class="cm">    ON DUPLICATE KEY UPDATE</span>
<span class="cm">    `country` = VALUES(`country`),</span>
<span class="cm">    `email` = VALUES(`email`),</span>
<span class="cm">    `name` = VALUES(`name`)</span>
<span class="cm">*/</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法不适用于批量插入更新。</p>
</div>
</section>
</section>
<section id="upsertbatch">
<h3><a class="toc-backref" href="#id65" role="doc-backlink">upsertBatch</a><a class="headerlink" href="#upsertbatch" title="此标题的永久链接"></a></h3>
<section id="builder-upsertbatch">
<h4>$builder-&gt;upsertBatch()<a class="headerlink" href="#builder-upsertbatch" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<section id="id28">
<h5>通过数据插入更新<a class="headerlink" href="#id28" title="此标题的永久链接"></a></h5>
<p>根据你提供的数据生成插入更新字符串,并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。默认情况下,约束将按顺序定义。首先选择主键,然后是唯一键。MySQL 将默认使用任何约束。</p>
<p>下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">,</span>
        <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span>
        <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;pedro@example.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El Salvador&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">upsertBatch</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="c1">// MySQLi  produces: INSERT INTO.. ON DUPLICATE KEY UPDATE..</span>
<span class="c1">// Postgre produces: INSERT INTO.. ON CONFLICT.. DO UPDATE..</span>
<span class="c1">// SQLite3 produces: INSERT INTO.. ON CONFLICT.. DO UPDATE..</span>
<span class="c1">// SQLSRV  produces: MERGE INTO.. WHEN MATCHED THEN UPDATE.. WHEN NOT MATCHED THEN INSERT..</span>
<span class="c1">// OCI8    produces: MERGE INTO.. WHEN MATCHED THEN UPDATE.. WHEN NOT MATCHED THEN INSERT..</span>
</pre></div>
</div>
<p>第一个参数是一个关联数组。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>所有值都会自动转义,生成更安全的查询。</p>
</div>
</section>
<section id="id29">
<h5>通过查询插入更新<a class="headerlink" href="#id29" title="此标题的永久链接"></a></h5>
<p>你也可以从查询中插入更新:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;user2&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user2.name, user2.email, user2.country&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;user.email = user2.email&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user.email IS NULL&#39;</span><span class="p">);</span>

<span class="nv">$additionalUpdateField</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;updated_at&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;CURRENT_TIMESTAMP&#39;</span><span class="p">)];</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setQueryAsData</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">updateFields</span><span class="p">(</span><span class="nv">$additionalUpdateField</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">upsertBatch</span><span class="p">();</span>
<span class="cm">/* MySQLi produces:</span>
<span class="cm">    INSERT INTO `db_user` (`country`, `email`, `name`)</span>
<span class="cm">    SELECT user2.name, user2.email, user2.country</span>
<span class="cm">    FROM user2</span>
<span class="cm">    LEFT JOIN user ON user.email = user2.email</span>
<span class="cm">    WHERE user.email IS NULL</span>
<span class="cm">    ON DUPLICATE KEY UPDATE</span>
<span class="cm">    `country` = VALUES(`country`),</span>
<span class="cm">    `email` = VALUES(`email`),</span>
<span class="cm">    `name` = VALUES(`name`),</span>
<span class="cm">    `updated_at` = CURRENT_TIMESTAMP</span>
<span class="cm">*/</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><code class="docutils literal notranslate"><span class="pre">setQueryAsData()</span></code>、<code class="docutils literal notranslate"><span class="pre">onConstraint()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">updateFields()</span></code> 方法可从 v4.3.0 开始使用。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>必须将选择查询的列别名为目标表的列名。</p>
</div>
</section>
</section>
<section id="builder-onconstraint">
<h4>$builder-&gt;onConstraint()<a class="headerlink" href="#builder-onconstraint" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>允许手动设置要用于插入更新的约束。这与 MySQL 不兼容,因为 MySQL 默认检查所有约束。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">upsert</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cm">/* Postgre produces:</span>
<span class="cm">    INSERT INTO &quot;db_user&quot;(&quot;country&quot;, &quot;email&quot;, &quot;id&quot;, &quot;name&quot;)</span>
<span class="cm">    VALUES (&#39;Iran&#39;,&#39;ahmadinejad@example.com&#39;,2,&#39;Ahmadinejad&#39;)</span>
<span class="cm">    ON CONFLICT(&quot;email&quot;)</span>
<span class="cm">    DO UPDATE SET</span>
<span class="cm">    &quot;country&quot; = &quot;excluded&quot;.&quot;country&quot;,</span>
<span class="cm">    &quot;id&quot; = &quot;excluded&quot;.&quot;id&quot;,</span>
<span class="cm">    &quot;name&quot; = &quot;excluded&quot;.&quot;name&quot;</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>此方法接受字符串或列数组。</p>
</section>
<section id="builder-updatefields">
<h4>$builder-&gt;updateFields()<a class="headerlink" href="#builder-updatefields" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>允许手动设置执行插入更新时要更新的字段。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad Zaghari&#39;</span><span class="p">,</span>
    <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Afghanistan&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">updateFields</span><span class="p">(</span><span class="s1">&#39;name, country&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;_upsert&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">upsert</span><span class="p">();</span>
<span class="cm">/* SQLSRV produces:</span>
<span class="cm">    MERGE INTO &quot;test&quot;.&quot;dbo&quot;.&quot;db_user&quot;</span>
<span class="cm">    USING (</span>
<span class="cm">     VALUES (&#39;Iran&#39;,&#39;ahmadinejad@example.com&#39;,2,&#39;Ahmadinejad&#39;)</span>
<span class="cm">    ) &quot;_upsert&quot; (&quot;country&quot;, &quot;email&quot;, &quot;id&quot;, &quot;name&quot;)</span>
<span class="cm">    ON (&quot;test&quot;.&quot;dbo&quot;.&quot;db_user&quot;.&quot;id&quot; = &quot;_upsert&quot;.&quot;id&quot;)</span>
<span class="cm">    WHEN MATCHED THEN UPDATE SET</span>
<span class="cm">    &quot;country&quot; = &quot;_upsert&quot;.&quot;country&quot;,</span>
<span class="cm">    &quot;name&quot; = &quot;_upsert&quot;.&quot;name&quot;</span>
<span class="cm">    WHEN NOT MATCHED THEN INSERT (&quot;country&quot;, &quot;email&quot;, &quot;id&quot;, &quot;name&quot;)</span>
<span class="cm">    VALUES (&quot;_upsert&quot;.&quot;country&quot;, &quot;_upsert&quot;.&quot;email&quot;, &quot;_upsert&quot;.&quot;id&quot;, &quot;_upsert&quot;.&quot;name&quot;);</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>此方法接受字符串、列数组或 RawSql。你还可以指定要更新的额外列,该列不包括在数据集中。这可以通过将第二个参数设置为 <code class="docutils literal notranslate"><span class="pre">true</span></code> 来完成。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;ahmadinejad@example.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Ahmadinejad&#39;</span><span class="p">,</span>
        <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;id&#39;</span>      <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span>
        <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;pedro@example.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Pedro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;El Salvador&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="nv">$additionalUpdateField</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;updated_at&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;CURRENT_TIMESTAMP&#39;</span><span class="p">)];</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">updateFields</span><span class="p">(</span><span class="nv">$additionalUpdateField</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">upsertBatch</span><span class="p">();</span>
<span class="cm">/* MySQLi produces:</span>
<span class="cm">    INSERT INTO `db_user` (`country`, `email`, `name`)</span>
<span class="cm">    VALUES (&#39;Iran&#39;,&#39;ahmadinejad@example.com&#39;,&#39;Ahmadinejad&#39;),(&#39;El Salvador&#39;,&#39;pedro@example.com&#39;,&#39;Pedro&#39;)</span>
<span class="cm">    ON DUPLICATE KEY UPDATE</span>
<span class="cm">    `country` = VALUES(`country`),</span>
<span class="cm">    `email` = VALUES(`email`),</span>
<span class="cm">    `name` = VALUES(`name`),</span>
<span class="cm">    `updated_at` = CURRENT_TIMESTAMP</span>
<span class="cm">*/</span>
</pre></div>
</div>
<p>请注意, <code class="docutils literal notranslate"><span class="pre">updated_at</span></code> 字段未插入但用于更新。</p>
</section>
</section>
</section>
<section id="id30">
<h2><a class="toc-backref" href="#id66" role="doc-backlink">更新数据</a><a class="headerlink" href="#id30" title="此标题的永久链接"></a></h2>
<section id="update">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">Update</a><a class="headerlink" href="#update" title="此标题的永久链接"></a></h3>
<section id="builder-replace">
<h4>$builder-&gt;replace()<a class="headerlink" href="#builder-replace" title="此标题的永久链接"></a></h4>
<p>这将执行一个 <strong>REPLACE</strong> 语句,基本上是可选的 <strong>DELETE</strong> + <strong>INSERT</strong> 的 SQL标准,使用 <em>PRIMARY</em> 和 <em>UNIQUE</em> 键作为确定因素。
在我们的例子中,它将省去你需要实现 select()、update()、delete() 和 insert() 调用的不同组合的复杂逻辑的需要。</p>
<p>例如:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My Name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;My date&#39;</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">replace</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="c1">// Executes: REPLACE INTO mytable (title, name, date) VALUES (&#39;My title&#39;, &#39;My name&#39;, &#39;My date&#39;)</span>
</pre></div>
</div>
<p>在上面的示例中,如果我们假设 <code class="docutils literal notranslate"><span class="pre">title</span></code> 字段是我们的主键,则如果一行包含 <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">title</span></code> 作为 <code class="docutils literal notranslate"><span class="pre">title</span></code> 值,则会删除该行,并用我们的新行数据替换它。</p>
<p>也允许使用 <code class="docutils literal notranslate"><span class="pre">set()</span></code> 方法,所有值都会自动转义,就像 <code class="docutils literal notranslate"><span class="pre">insert()</span></code> 一样。</p>
</section>
<section id="builder-set">
<h4>$builder-&gt;set()<a class="headerlink" href="#builder-set" title="此标题的永久链接"></a></h4>
<p>此方法使你可以为以后通过 <code class="docutils literal notranslate"><span class="pre">insert()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">update()</span></code> 方法传入的插入或更新设置值。</p>
<p><strong>它可以代替直接将数据数组传递给 insert() 或 update() 方法:</strong></p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">();</span>
<span class="c1">// Produces: INSERT INTO mytable (`name`) VALUES (&#39;{$name}&#39;)</span>
</pre></div>
</div>
<p>如果使用多个方法调用,它们将根据你执行插入还是更新来正确组装:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="nv">$title</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="nv">$status</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">();</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">set()</span></code> 也将接受一个可选的第三个参数(<code class="docutils literal notranslate"><span class="pre">$escape</span></code>),如果设置为 <code class="docutils literal notranslate"><span class="pre">false</span></code> 将阻止对值进行转义。为了说明差异,这里 <code class="docutils literal notranslate"><span class="pre">set()</span></code> 同时使用和不使用 escape 参数的示例。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;field&#39;</span><span class="p">,</span> <span class="s1">&#39;field+1&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">();</span>
<span class="c1">// gives UPDATE mytable SET field = field+1 WHERE `id` = 2</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;field&#39;</span><span class="p">,</span> <span class="s1">&#39;field+1&#39;</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">();</span>
<span class="c1">// gives UPDATE `mytable` SET `field` = &#39;field+1&#39; WHERE `id` = 2</span>
</pre></div>
</div>
<p>你也可以向此方法传递关联数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;name&#39;</span>   <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$title</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nv">$status</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">();</span>
</pre></div>
</div>
<p>或者一个对象:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Libraries</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$title</span>   <span class="o">=</span> <span class="s1">&#39;My Title&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s1">&#39;My Content&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$date</span>    <span class="o">=</span> <span class="s1">&#39;My Date&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">App\Libraries\MyClass</span><span class="p">;</span>

<span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$object</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="builder-update">
<h4>$builder-&gt;update()<a class="headerlink" href="#builder-update" title="此标题的永久链接"></a></h4>
<p>根据你提供的数据生成 update 字符串并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nv">$title</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
    <span class="s1">&#39;date&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$date</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * UPDATE mytable</span>
<span class="cm"> * SET title = &#39;{$title}&#39;, name = &#39;{$name}&#39;, date = &#39;{$date}&#39;</span>
<span class="cm"> * WHERE id = $id</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>或者你可以提供一个对象:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Libraries</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$title</span>   <span class="o">=</span> <span class="s1">&#39;My Title&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s1">&#39;My Content&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$date</span>    <span class="o">=</span> <span class="s1">&#39;My Date&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">App\Libraries\MyClass</span><span class="p">;</span>

<span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="nv">$object</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * UPDATE `mytable`</span>
<span class="cm"> * SET `title` = &#39;{$title}&#39;, `content` = &#39;{$content}&#39;, `date` = &#39;{$date}&#39;</span>
<span class="cm"> * WHERE id = `$id`</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 外,所有值都会自动转义,生成更安全的查询。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对数据进行转义。否则可能会导致 SQL 注入。</p>
</div>
<p>你会注意到使用了 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;where()</span></code> 方法,使你可以设置 <strong>WHERE</strong> 子句。
你可以选择直接将此信息作为字符串传递给 <code class="docutils literal notranslate"><span class="pre">update()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="s1">&#39;id = 4&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>或者作为数组:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">]);</span>
</pre></div>
</div>
<p>你也可以在执行更新时使用上面描述的 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;set()</span></code> 方法。</p>
</section>
<section id="builder-getcompiledupdate">
<h4>$builder-&gt;getCompiledUpdate()<a class="headerlink" href="#builder-getcompiledupdate" title="此标题的永久链接"></a></h4>
<p>此方法的工作方式与 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;getCompiledInsert()</span></code> 完全相同，只是它生成的是 <strong>UPDATE</strong> SQL 字符串，而不是 <strong>INSERT</strong> SQL 字符串。</p>
<p>要获取更多信息，请查看 <a class="reference internal" href="#builder-getcompiledinsert">$builder-&gt;getCompiledInsert()</a> 的文档。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>这个方法不适用于批量更新。</p>
</div>
</section>
</section>
<section id="updatebatch">
<span id="update-batch"></span><h3><a class="toc-backref" href="#id68" role="doc-backlink">UpdateBatch</a><a class="headerlink" href="#updatebatch" title="此标题的永久链接"></a></h3>
<section id="builder-updatebatch">
<h4>$builder-&gt;updateBatch()<a class="headerlink" href="#builder-updatebatch" title="此标题的永久链接"></a></h4>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v4.3.0 开始, <code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code> 的第二个参数 <code class="docutils literal notranslate"><span class="pre">$index</span></code> 改为 <code class="docutils literal notranslate"><span class="pre">$constraints</span></code>。它现在接受数组、字符串或 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 类型。</p>
</div>
<section id="id31">
<h5>通过数据更新<a class="headerlink" href="#id31" title="此标题的永久链接"></a></h5>
<p>根据你提供的数据生成 update 字符串,并运行查询。你可以将一个 <strong>数组</strong> 或 <strong>对象</strong> 传递给该方法。下面是一个使用数组的示例:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Title 1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;author&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Author 1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Name 1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Date 1&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Title 2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;author&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Author 2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Name 2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Date 2&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">]);</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * UPDATE `mytable`</span>
<span class="cm"> * INNER JOIN (</span>
<span class="cm"> * SELECT &#39;Title 1&#39; `title`, &#39;Author 1&#39; `author`, &#39;Name 1&#39; `name`, &#39;Date 1&#39; `date` UNION ALL</span>
<span class="cm"> * SELECT &#39;Title 2&#39; `title`, &#39;Author 2&#39; `author`, &#39;Name 2&#39; `name`, &#39;Date 2&#39; `date`</span>
<span class="cm"> * ) `u`</span>
<span class="cm"> * ON `mytable`.`title` = `u`.`title` AND `mytable`.`author` = `u`.`author`</span>
<span class="cm"> * SET</span>
<span class="cm"> * `mytable`.`title` = `u`.`title`,</span>
<span class="cm"> * `mytable`.`name` = `u`.`name`,</span>
<span class="cm"> * `mytable`.`date` = `u`.`date`</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>第一个参数是一个关联数组,第二个参数是 where 键。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v4.3.0 开始,生成的 SQL 结构得到了改进。</p>
</div>
<p>从 v4.3.0 开始,你也可以使用 <code class="docutils literal notranslate"><span class="pre">onConstraint()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">updateFields()</span></code> 方法:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;title, author&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">();</span>

<span class="c1">// OR</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">([</span><span class="s1">&#39;`mytable`.`title`&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;`u`.`title`&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;`u`.`author`&#39;</span><span class="p">)])</span>
    <span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">();</span>

<span class="c1">// OR</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="p">}</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;title, author&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">();</span>

<span class="c1">// OR</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;`mytable`.`title` = `u`.`title` AND `mytable`.`author` = `u`.`author`&#39;</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">updateFields</span><span class="p">([</span><span class="s1">&#39;last_update&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;CURRENT_TIMESTAMP()&#39;</span><span class="p">)],</span> <span class="k">true</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * UPDATE `mytable`</span>
<span class="cm"> * INNER JOIN (</span>
<span class="cm"> * SELECT &#39;Title 1&#39; `title`, &#39;Author 1&#39; `author`, &#39;Name 1&#39; `name`, &#39;Date 1&#39; `date` UNION ALL</span>
<span class="cm"> * SELECT &#39;Title 2&#39; `title`, &#39;Author 2&#39; `author`, &#39;Name 2&#39; `name`, &#39;Date 2&#39; `date`</span>
<span class="cm"> * ) `u`</span>
<span class="cm"> * ON `mytable`.`title` = `u`.`title` AND `mytable`.`author` = `u`.`author`</span>
<span class="cm"> * SET</span>
<span class="cm"> * `mytable`.`title` = `u`.`title`,</span>
<span class="cm"> * `mytable`.`name` = `u`.`name`,</span>
<span class="cm"> * `mytable`.`date` = `u`.`date`,</span>
<span class="cm"> * `mytable`.`last_update` = CURRENT_TIMESTAMP() // this only applies to the last scenario</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 外,所有值都会自动转义,生成更安全的查询。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当你使用 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code> 时,必须手动对数据进行转义。否则可能会导致 SQL 注入。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由于这项工作的性质,此方法无法为 <code class="docutils literal notranslate"><span class="pre">affectedRows()</span></code> 提供适当的结果。
相反, <code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code> 返回受影响的行数。</p>
</div>
</section>
<section id="id32">
<h5>通过查询更新<a class="headerlink" href="#id32" title="此标题的永久链接"></a></h5>
<p>从 v4.3.0 开始，你也可以使用 <code class="docutils literal notranslate"><span class="pre">setQueryAsData()</span></code> 方法从查询中进行更新：</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;user2&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;user2.name, user2.email, user2.country&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;user.email = user2.email&#39;</span><span class="p">,</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;user2.country&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">);</span>

<span class="nv">$additionalUpdateField</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;updated_at&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">RawSql</span><span class="p">(</span><span class="s1">&#39;CURRENT_TIMESTAMP&#39;</span><span class="p">)];</span>

<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">setQueryAsData</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">updateFields</span><span class="p">(</span><span class="nv">$additionalUpdateField</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">updateBatch</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * UPDATE `user`</span>
<span class="cm"> * INNER JOIN (</span>
<span class="cm"> * SELECT user2.name, user2.email, user2.country</span>
<span class="cm"> * FROM user2</span>
<span class="cm"> * INNER JOIN user ON user.email = user2.email</span>
<span class="cm"> * WHERE user2.country = &#39;US&#39;</span>
<span class="cm"> * ) `u`</span>
<span class="cm"> * ON `user`.`email` = `u`.`email`</span>
<span class="cm"> * SET</span>
<span class="cm"> * `mytable`.`name` = `u`.`name`,</span>
<span class="cm"> * `mytable`.`email` = `u`.`email`,</span>
<span class="cm"> * `mytable`.`country` = `u`.`country`,</span>
<span class="cm"> * `mytable`.`updated_at` = CURRENT_TIMESTAMP()</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>必须将选择查询的列别名为目标表的列名。</p>
</div>
</section>
</section>
</section>
</section>
<section id="id33">
<h2><a class="toc-backref" href="#id69" role="doc-backlink">删除数据</a><a class="headerlink" href="#id33" title="此标题的永久链接"></a></h2>
<section id="delete">
<h3><a class="toc-backref" href="#id70" role="doc-backlink">Delete</a><a class="headerlink" href="#delete" title="此标题的永久链接"></a></h3>
<section id="builder-delete">
<h4>$builder-&gt;delete()<a class="headerlink" href="#builder-delete" title="此标题的永久链接"></a></h4>
<p>生成 <strong>DELETE</strong> SQL 字符串并运行查询。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">([</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">]);</span>
<span class="c1">// Produces: DELETE FROM mytable WHERE id = $id</span>
</pre></div>
</div>
<p>第一个参数是 where 子句。
你也可以使用 <code class="docutils literal notranslate"><span class="pre">where()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">orWhere()</span></code> 方法,而不是将数据传递给方法的第一个参数:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">);</span>
<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produces:</span>
<span class="cm"> * DELETE FROM mytable</span>
<span class="cm"> * WHERE id = $id</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>如果要从表中删除所有数据,可以使用 <code class="docutils literal notranslate"><span class="pre">truncate()</span></code> 方法或 <code class="docutils literal notranslate"><span class="pre">emptyTable()</span></code>。</p>
</section>
<section id="builder-getcompileddelete">
<h4>$builder-&gt;getCompiledDelete()<a class="headerlink" href="#builder-getcompileddelete" title="此标题的永久链接"></a></h4>
<p>此方法的工作方式与 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;getCompiledInsert()</span></code> 完全相同,只是它生成 <strong>DELETE</strong> SQL 字符串而不是 <strong>INSERT</strong> SQL 字符串。</p>
<p>有关更多信息,请查看 <a class="reference internal" href="#builder-getcompiledinsert">$builder-&gt;getCompiledInsert()</a> 的文档。</p>
</section>
</section>
<section id="deletebatch">
<span id="delete-batch"></span><h3><a class="toc-backref" href="#id71" role="doc-backlink">DeleteBatch</a><a class="headerlink" href="#deletebatch" title="此标题的永久链接"></a></h3>
<section id="builder-deletebatch">
<h4>$builder-&gt;deleteBatch()<a class="headerlink" href="#builder-deletebatch" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<section id="id34">
<h5>通过数据删除<a class="headerlink" href="#id34" title="此标题的永久链接"></a></h5>
<p>根据一组数据生成批量 <strong>DELETE</strong> 语句。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">&#39;order&#39;</span>   <span class="o">=&gt;</span> <span class="mi">48372</span><span class="p">,</span>
        <span class="s1">&#39;line&#39;</span>    <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s1">&#39;product&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Keyboard&#39;</span><span class="p">,</span>
        <span class="s1">&#39;qty&#39;</span>     <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;order&#39;</span>   <span class="o">=&gt;</span> <span class="mi">48372</span><span class="p">,</span>
        <span class="s1">&#39;line&#39;</span>    <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;product&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">,</span>
        <span class="s1">&#39;qty&#39;</span>     <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">&#39;order&#39;</span>   <span class="o">=&gt;</span> <span class="mi">48372</span><span class="p">,</span>
        <span class="s1">&#39;line&#39;</span>    <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;product&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Monitor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;qty&#39;</span>     <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="s1">&#39;del&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;order, line&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;del.qty &gt;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">deleteBatch</span><span class="p">();</span>

<span class="cm">/*</span>
<span class="cm"> * MySQL Produces:</span>
<span class="cm"> * DELETE `order_line` FROM `order_line`</span>
<span class="cm"> * INNER JOIN (</span>
<span class="cm"> * SELECT 3 `line`, 48372 `order`, &#39;Keyboard&#39; `product`, 1 `qty` UNION ALL</span>
<span class="cm"> * SELECT 4 `line`, 48372 `order`, &#39;Mouse&#39;    `product`, 1 `qty` UNION ALL</span>
<span class="cm"> * SELECT 5 `line`, 48372 `order`, &#39;Monitor&#39;  `product`, 2 `qty`</span>
<span class="cm"> * ) `del`</span>
<span class="cm"> * ON `order_line`.`order` = `del`.`order` AND `order_line`.`line` = `del`.`line`</span>
<span class="cm"> * WHERE `del`.`qty` &gt; 1</span>
<span class="cm"> */</span>
</pre></div>
</div>
<p>当在具有复合主键的表中删除数据时,此方法特别有用。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>SQLite3 不支持使用 <code class="docutils literal notranslate"><span class="pre">where()</span></code>。</p>
</div>
</section>
<section id="id35">
<h5>通过查询删除<a class="headerlink" href="#id35" title="此标题的永久链接"></a></h5>
<p>你也可以从查询中删除:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Database\RawSql</span><span class="p">;</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;user2&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;email, name, country&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;Greece&#39;</span><span class="p">);</span>

<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">setQueryAsData</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">onConstraint</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;alias.name = user.name&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">deleteBatch</span><span class="p">();</span>

<span class="cm">/* MySQLi produces:</span>
<span class="cm">    DELETE `user` FROM `user`</span>
<span class="cm">    INNER JOIN (</span>
<span class="cm">    SELECT `email`, `name`, `country`</span>
<span class="cm">    FROM `user2`</span>
<span class="cm">    WHERE `country` = &#39;Greece&#39;) `alias`</span>
<span class="cm">    ON `user`.`email` = `alias`.`email`</span>
<span class="cm">    WHERE `alias`.`name` = `user`.`name`</span>
<span class="cm">*/</span>
</pre></div>
</div>
</section>
</section>
<section id="builder-emptytable">
<h4>$builder-&gt;emptyTable()<a class="headerlink" href="#builder-emptytable" title="此标题的永久链接"></a></h4>
<p>生成 <strong>DELETE</strong> SQL 字符串并运行查询:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">emptyTable</span><span class="p">(</span><span class="s1">&#39;mytable&#39;</span><span class="p">);</span>
<span class="c1">// Produces: DELETE FROM mytable</span>
</pre></div>
</div>
</section>
<section id="builder-truncate">
<h4>$builder-&gt;truncate()<a class="headerlink" href="#builder-truncate" title="此标题的永久链接"></a></h4>
<p>生成 <strong>TRUNCATE</strong> SQL 字符串并运行查询。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">truncate</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Produce:</span>
<span class="cm"> * TRUNCATE mytable</span>
<span class="cm"> */</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果不可用 TRUNCATE 命令, <code class="docutils literal notranslate"><span class="pre">truncate()</span></code> 将使用 <code class="docutils literal notranslate"><span class="pre">DELETE</span> <span class="pre">FROM</span> <span class="pre">table</span></code>。</p>
</div>
</section>
</section>
</section>
<section id="id36">
<h2><a class="toc-backref" href="#id72" role="doc-backlink">条件语句</a><a class="headerlink" href="#id36" title="此标题的永久链接"></a></h2>
<section id="when">
<span id="db-builder-when"></span><h3><a class="toc-backref" href="#id73" role="doc-backlink">When</a><a class="headerlink" href="#when" title="此标题的永久链接"></a></h3>
<section id="builder-when">
<h4>$builder-&gt;when()<a class="headerlink" href="#builder-when" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>这允许基于条件修改查询,而不会打破查询构建器链。第一个参数是条件,它应该评估为布尔值。第二个参数是可调用的,它将在条件为 true 时运行。</p>
<p>例如,你可能只想应用给定的 WHERE 语句基于 HTTP 请求中发送的值:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$status</span> <span class="o">=</span> <span class="nx">service</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getPost</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">);</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">when</span><span class="p">(</span><span class="nv">$status</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$status</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="nv">$status</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
<p>由于条件评估为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,所以可调用的将被调用。条件中设置的值将作为第二个参数传递给可调用的,以便可以在查询中使用它。</p>
<p>有时你可能希望在条件评估为 false 时应用不同的语句。这可以通过提供第二个闭包来实现:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$onlyInactive</span> <span class="o">=</span> <span class="nx">service</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getPost</span><span class="p">(</span><span class="s1">&#39;return_inactive&#39;</span><span class="p">);</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">when</span><span class="p">(</span><span class="nv">$onlyInactive</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$onlyInactive</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
</section>
</section>
<section id="whennot">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">WhenNot</a><a class="headerlink" href="#whennot" title="此标题的永久链接"></a></h3>
<section id="builder-whennot">
<h4>$builder-&gt;whenNot()<a class="headerlink" href="#builder-whennot" title="此标题的永久链接"></a></h4>
<div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<p>这与 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;when()</span></code> 的工作方式完全相同,只是它只有在条件评估为 <code class="docutils literal notranslate"><span class="pre">false</span></code> 时才会运行可调用的,而不是像 <code class="docutils literal notranslate"><span class="pre">when()</span></code> 中的 <code class="docutils literal notranslate"><span class="pre">true</span></code>。</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$status</span> <span class="o">=</span> <span class="nx">service</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getPost</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">);</span>

<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">whenNot</span><span class="p">(</span><span class="nv">$status</span><span class="p">,</span> <span class="k">static</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$status</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id37">
<h2><a class="toc-backref" href="#id75" role="doc-backlink">方法链</a><a class="headerlink" href="#id37" title="此标题的永久链接"></a></h2>
<p>方法链允许你通过连接多个方法来简化语法。考虑这个例子:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="ar-caching">
<span id="id38"></span><h2><a class="toc-backref" href="#id76" role="doc-backlink">重置查询构建器</a><a class="headerlink" href="#ar-caching" title="此标题的永久链接"></a></h2>
<section id="resetquery">
<h3><a class="toc-backref" href="#id77" role="doc-backlink">ResetQuery</a><a class="headerlink" href="#resetquery" title="此标题的永久链接"></a></h3>
<section id="builder-resetquery">
<h4>$builder-&gt;resetQuery()<a class="headerlink" href="#builder-resetquery" title="此标题的永久链接"></a></h4>
<p>重置查询构建器允许你在不先使用 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;get()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;insert()</span></code> 等方法执行查询的情况下重新开始查询。</p>
<p>当你使用查询构建器生成 SQL(例如 <code class="docutils literal notranslate"><span class="pre">$builder-&gt;getCompiledSelect()</span></code>),然后选择运行查询时,这很有用:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="c1">// Note that the parameter of the `getCompiledSelect()` method is false</span>
<span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">([</span><span class="s1">&#39;field1&#39;</span><span class="p">,</span> <span class="s1">&#39;field2&#39;</span><span class="p">])</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;field3&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">getCompiledSelect</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

<span class="c1">// ...</span>
<span class="c1">// Do something crazy with the SQL code... like add it to a cron script for</span>
<span class="c1">// later execution or something...</span>
<span class="c1">// ...</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getResultArray</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm"> * Would execute and return an array of results of the following query:</span>
<span class="cm"> * SELECT field1, field2 FROM mytable WHERE field3 = 5;</span>
<span class="cm"> */</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="namespace-CodeIgniter\Database">
<span id="id39"></span><h2><a class="toc-backref" href="#id78" role="doc-backlink">类参考</a><a class="headerlink" href="#namespace-CodeIgniter\Database" title="此标题的永久链接"></a></h2>
<dl class="php class">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">CodeIgniter\Database\</span></span><span class="sig-name descname"><span class="pre">BaseBuilder</span></span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder" title="永久链接至目标"></a></dt>
<dd><dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::db">
<span class="sig-name descname"><span class="pre">db</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::db" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>正在使用的数据库连接</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ConnectionInterface</span></code></p>
</dd>
</dl>
<p>从 <code class="docutils literal notranslate"><span class="pre">$db</span></code> 返回当前数据库连接。用于访问查询构建器无法直接使用的 <code class="docutils literal notranslate"><span class="pre">ConnectionInterface</span></code> 方法,如 <code class="docutils literal notranslate"><span class="pre">insertID()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">errors()</span></code>。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::resetQuery">
<span class="sig-name descname"><span class="pre">resetQuery</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::resetQuery" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>重置当前的查询构建器状态。当你想要构建可在某些条件下取消的查询时很有用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::countAllResults">
<span class="sig-name descname"><span class="pre">countAllResults</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::countAllResults" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置 SELECT 的值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>查询结果中的行数</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
<p>生成平台特定的查询字符串,用于统计查询构建器查询返回的所有记录。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::countAll">
<span class="sig-name descname"><span class="pre">countAll</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::countAll" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置 SELECT 的值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>查询结果中的行数</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
<p>生成平台特定的查询字符串,用于统计特定表中的所有记录。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[$limit</span> <span class="pre">=</span> <span class="pre">null[,</span> <span class="pre">$offset</span> <span class="pre">=</span> <span class="pre">null[,</span> <span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true]]]]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::get" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$limit</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – LIMIT 子句</p></li>
<li><p><strong>$offset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – OFFSET 子句</p></li>
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否要清除查询构建器的值?</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">\CodeIgniter\Database\ResultInterface</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">\CodeIgniter\Database\ResultInterface</span></code></p>
</dd>
</dl>
<p>编译并运行基于已经调用的查询构建器方法的 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 语句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::getWhere">
<span class="sig-name descname"><span class="pre">getWhere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[$where</span> <span class="pre">=</span> <span class="pre">null[,</span> <span class="pre">$limit</span> <span class="pre">=</span> <span class="pre">null[,</span> <span class="pre">$offset</span> <span class="pre">=</span> <span class="pre">null[,</span> <span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true]]]]]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::getWhere" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$where</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – WHERE 子句</p></li>
<li><p><strong>$limit</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – LIMIT 子句</p></li>
<li><p><strong>$offset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – OFFSET 子句</p></li>
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否要清除查询构建器的值?</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">\CodeIgniter\Database\ResultInterface</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">\CodeIgniter\Database\ResultInterface</span></code></p>
</dd>
</dl>
<p>与 <code class="docutils literal notranslate"><span class="pre">get()</span></code> 相同,但也允许直接添加 WHERE。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">'*'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::select" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|RawSql|string</span></code></span>) – 查询的 SELECT 部分</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectAvg">
<span class="sig-name descname"><span class="pre">selectAvg</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectAvg" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要计算平均值的字段</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">AVG(field)</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectMax">
<span class="sig-name descname"><span class="pre">selectMax</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectMax" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要计算最大值的字段</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">MAX(field)</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectMin">
<span class="sig-name descname"><span class="pre">selectMin</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectMin" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要计算最小值的字段</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">MIN(field)</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectSum">
<span class="sig-name descname"><span class="pre">selectSum</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectSum" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要计算总和的字段</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">SUM(field)</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectCount">
<span class="sig-name descname"><span class="pre">selectCount</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$select</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectCount" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$select</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要计算平均值的字段</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">COUNT(field)</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::selectSubquery">
<span class="sig-name descname"><span class="pre">selectSubquery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">BaseBuilder</span> <span class="pre">$subquery</span></em>, <em class="sig-param"><span class="pre">string</span> <span class="pre">$as</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::selectSubquery" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$subquery</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – BaseBuilder 的实例</p></li>
<li><p><strong>$as</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 结果值名称的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向选择添加子查询</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::distinct">
<span class="sig-name descname"><span class="pre">distinct</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$val</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::distinct" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$val</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – “distinct” 标志的期望值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>设置一个标志,告诉查询构建器向查询的 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 部分添加 <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::from">
<span class="sig-name descname"><span class="pre">from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$from</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$overwrite</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::from" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$from</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 表名(字符串或数组)</p></li>
<li><p><strong>$overwrite</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否删除第一个已存在的表?</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>指定查询的 <code class="docutils literal notranslate"><span class="pre">FROM</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::fromSubquery">
<span class="sig-name descname"><span class="pre">fromSubquery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$from</span></em>, <em class="sig-param"><span class="pre">$alias</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::fromSubquery" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$from</strong> (<span><a class="reference internal" href="#CodeIgniter\Database\BaseBuilder" title="CodeIgniter\Database\BaseBuilder"><code class="xref php php-obj docutils literal notranslate"><span class="pre">BaseBuilder</span></code></a></span>) – BaseBuilder 类的实例</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 子查询的别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>使用子查询指定查询的 <code class="docutils literal notranslate"><span class="pre">FROM</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::setQueryAsData">
<span class="sig-name descname"><span class="pre">setQueryAsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$query</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$columns</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::setQueryAsData" title="永久链接至目标"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$query</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">BaseBuilder|RawSql</span></code></span>) – BaseBuilder 或 RawSql 的实例</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string|null</span></code></span>) – 查询的别名</p></li>
<li><p><strong>$columns</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|string|null</span></code></span>) – 查询中的列,以数组或逗号分隔的字符串表示</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>为 <code class="docutils literal notranslate"><span class="pre">insertBatch()</span></code>、<code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code>、<code class="docutils literal notranslate"><span class="pre">upsertBatch()</span></code> 设置查询作为数据源。
如果 <code class="docutils literal notranslate"><span class="pre">$columns</span></code> 为 null,则会运行查询来生成列名。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$table</span></em>, <em class="sig-param"><span class="pre">$cond</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$type</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::join" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$table</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要连接的表名</p></li>
<li><p><strong>$cond</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – JOIN ON 条件</p></li>
<li><p><strong>$type</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – JOIN 类型</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">JOIN</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::where">
<span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::where" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|RawSql|string</span></code></span>) – 要比较的字段名称,或关联数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 如果是单个键,则与此值进行比较</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成查询的 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 部分。使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orWhere">
<span class="sig-name descname"><span class="pre">orWhere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orWhere" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 要比较的字段名称,或关联数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 如果是单个键,则与此值进行比较</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成查询的 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 部分。使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orWhereIn">
<span class="sig-name descname"><span class="pre">orWhereIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orWhereIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要搜索的字段</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组,或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL 查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orWhereNotIn">
<span class="sig-name descname"><span class="pre">orWhereNotIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orWhereNotIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要搜索的字段</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组,或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL 查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::whereIn">
<span class="sig-name descname"><span class="pre">whereIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::whereIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要检查的字段名称</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组,或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL 查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::whereNotIn">
<span class="sig-name descname"><span class="pre">whereNotIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::whereNotIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要检查的字段名称</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组,或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL 查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::groupStart">
<span class="sig-name descname"><span class="pre">groupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::groupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orGroupStart">
<span class="sig-name descname"><span class="pre">orGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::notGroupStart">
<span class="sig-name descname"><span class="pre">notGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::notGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">AND</span> <span class="pre">NOT</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orNotGroupStart">
<span class="sig-name descname"><span class="pre">orNotGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orNotGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">OR</span> <span class="pre">NOT</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::groupEnd">
<span class="sig-name descname"><span class="pre">groupEnd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::groupEnd" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>结束一个组表达式。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::like">
<span class="sig-name descname"><span class="pre">like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::like" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|RawSql|string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orLike">
<span class="sig-name descname"><span class="pre">orLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::notLike">
<span class="sig-name descname"><span class="pre">notLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::notLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orNotLike">
<span class="sig-name descname"><span class="pre">orNotLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orNotLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::having">
<span class="sig-name descname"><span class="pre">having</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::having" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 标识符(字符串)或字段/值对的关联数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 如果 $key 是标识符,则查找此值</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orHaving">
<span class="sig-name descname"><span class="pre">orHaving</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orHaving" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 标识符(字符串)或字段/值对的关联数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 如果 $key 是标识符,则查找此值</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orHavingIn">
<span class="sig-name descname"><span class="pre">orHavingIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orHavingIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要搜索的字段</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orHavingNotIn">
<span class="sig-name descname"><span class="pre">orHavingNotIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orHavingNotIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要搜索的字段</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::havingIn">
<span class="sig-name descname"><span class="pre">havingIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::havingIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要检查的字段名称</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::havingNotIn">
<span class="sig-name descname"><span class="pre">havingNotIn</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$key</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$values</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::havingNotIn" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要检查的字段名称</p></li>
<li><p><strong>$values</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|BaseBulder|Closure</span></code></span>) – 目标值的数组或子查询的匿名函数</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>生成 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 字段 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">IN('item',</span> <span class="pre">'item')</span></code> SQL查询,如果适用的话,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::havingLike">
<span class="sig-name descname"><span class="pre">havingLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::havingLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 部分添加 <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orHavingLike">
<span class="sig-name descname"><span class="pre">orHavingLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orHavingLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 部分添加 <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::notHavingLike">
<span class="sig-name descname"><span class="pre">notHavingLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::notHavingLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
<li><p><strong>$insensitiveSearch</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否强制执行不区分大小写的搜索</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 部分添加 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orNotHavingLike">
<span class="sig-name descname"><span class="pre">orNotHavingLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$field</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$match</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$side</span> <span class="pre">=</span> <span class="pre">'both'</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$insensitiveSearch</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orNotHavingLike" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$field</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 字段名称</p></li>
<li><p><strong>$match</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要匹配的文本部分</p></li>
<li><p><strong>$side</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 在表达式的哪一侧放置 ‘%’ 通配符</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 部分添加 <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">LIKE</span></code> 子句,使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 分隔多个调用。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::havingGroupStart">
<span class="sig-name descname"><span class="pre">havingGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::havingGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句的一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">AND</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orHavingGroupStart">
<span class="sig-name descname"><span class="pre">orHavingGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orHavingGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句的一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">OR</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::notHavingGroupStart">
<span class="sig-name descname"><span class="pre">notHavingGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::notHavingGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句的一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">AND</span> <span class="pre">NOT</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orNotHavingGroupStart">
<span class="sig-name descname"><span class="pre">orNotHavingGroupStart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orNotHavingGroupStart" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>启动 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句的一个组表达式,对表达式内的条件使用 <code class="docutils literal notranslate"><span class="pre">OR</span> <span class="pre">NOT</span></code> 连接。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::havingGroupEnd">
<span class="sig-name descname"><span class="pre">havingGroupEnd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::havingGroupEnd" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>结束 <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> 子句的一个组表达式。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::groupBy">
<span class="sig-name descname"><span class="pre">groupBy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$by</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::groupBy" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$by</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 要分组的字段;字符串或数组</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::orderBy">
<span class="sig-name descname"><span class="pre">orderBy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$orderby</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$direction</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::orderBy" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$orderby</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要排序的字段</p></li>
<li><p><strong>$direction</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 请求的排序方向 - ASC、DESC 或 random</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值和标识符</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::limit">
<span class="sig-name descname"><span class="pre">limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$value</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$offset</span> <span class="pre">=</span> <span class="pre">0</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::limit" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 要限制结果的行数</p></li>
<li><p><strong>$offset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 要跳过的行数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> 和 <code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::offset">
<span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$offset</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::offset" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$offset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 要跳过的行数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>向查询添加 <code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::union">
<span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$union</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::union" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$union</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">BaseBulder|Closure</span></code></span>) – 联合查询</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>添加 <code class="docutils literal notranslate"><span class="pre">UNION</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::unionAll">
<span class="sig-name descname"><span class="pre">unionAll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$union</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::unionAll" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$union</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">BaseBulder|Closure</span></code></span>) – 联合查询</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>添加 <code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> 子句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::set" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 字段名称,或字段/值对的数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 如果 $key 是单个字段,则为字段值</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>添加通过 <code class="docutils literal notranslate"><span class="pre">insert()</span></code>、<code class="docutils literal notranslate"><span class="pre">update()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">replace()</span></code> 稍后传入的字段/值对。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::insert" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 字段/值对的关联数组</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p>编译并执行 <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> 语句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::insertBatch">
<span class="sig-name descname"><span class="pre">insertBatch</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$batch_size</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::insertBatch" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 要插入的数据</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
<li><p><strong>$batch_size</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 一次插入的行数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>插入的行数,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int|false</span></code></span></p>
</dd>
</dl>
<p>编译并执行批量 <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> 语句。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当提供多于 <code class="docutils literal notranslate"><span class="pre">$batch_size</span></code> 行时,会执行多个
<code class="docutils literal notranslate"><span class="pre">INSERT</span></code> 查询,每个试图插入最多 <code class="docutils literal notranslate"><span class="pre">$batch_size</span></code> 行。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::setInsertBatch">
<span class="sig-name descname"><span class="pre">setInsertBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::setInsertBatch" title="永久链接至目标"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">自 4.3.0 版本弃用: </span>请使用 <a class="reference internal" href="#CodeIgniter\Database\BaseBuilder::setData" title="CodeIgniter\Database\BaseBuilder::setData"><code class="xref php php-meth docutils literal notranslate"><span class="pre">CodeIgniter\Database\BaseBuilder::setData()</span></code></a> 替代。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 字段名称或字段/值对数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 如果 $key 是单个字段,则为字段值</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>添加后面通过 <code class="docutils literal notranslate"><span class="pre">insertBatch()</span></code> 批量插入到表中的字段/值对。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>此方法不建议使用。将在未来版本中删除。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::upsert">
<span class="sig-name descname"><span class="pre">upsert</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::upsert" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 字段/值对的关联数组</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p>编译并执行 <code class="docutils literal notranslate"><span class="pre">UPSERT</span></code> 语句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::upsertBatch">
<span class="sig-name descname"><span class="pre">upsertBatch</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$batch_size</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::upsertBatch" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 要插入更新的数据</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
<li><p><strong>$batch_size</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 一次插入更新的行数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>插入更新的行数,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int|false</span></code></span></p>
</dd>
</dl>
<p>编译并执行批量 <code class="docutils literal notranslate"><span class="pre">UPSERT</span></code> 语句。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>MySQL 使用 <code class="docutils literal notranslate"><span class="pre">ON</span> <span class="pre">DUPLICATE</span> <span class="pre">KEY</span> <span class="pre">UPDATE</span></code>,每行的 affected-rows 值
如果行作为新行插入,则为 1;如果更新了现有行,则为 2;如果现有行设置为其当前值,则为 0。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当提供多于 <code class="docutils literal notranslate"><span class="pre">$batch_size</span></code> 行时,会执行多个
<code class="docutils literal notranslate"><span class="pre">UPSERT</span></code> 查询,每个试图插入更新最多 <code class="docutils literal notranslate"><span class="pre">$batch_size</span></code> 行。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$where</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$limit</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::update" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 字段/值对的关联数组</p></li>
<li><p><strong>$where</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – WHERE 子句</p></li>
<li><p><strong>$limit</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – LIMIT 子句</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p>编译并执行 <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> 语句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::updateBatch">
<span class="sig-name descname"><span class="pre">updateBatch</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$constraints</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$batchSize</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::updateBatch" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|object|null</span></code></span>) – 字段名称,或字段/值对的关联数组</p></li>
<li><p><strong>$constraints</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|RawSql|string|null</span></code></span>) – 用作更新键的字段或字段集。</p></li>
<li><p><strong>$batchSize</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 每个查询分组的条件数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>更新的行数,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int|false</span></code></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v4.3.0 开始,参数 <code class="docutils literal notranslate"><span class="pre">$set</span></code> 和 <code class="docutils literal notranslate"><span class="pre">$constraints</span></code> 的类型发生了变化。</p>
</div>
<p>编译并执行批量 <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> 语句。
<code class="docutils literal notranslate"><span class="pre">$constraints</span></code> 参数接受逗号分隔的列字符串,数组,关联数组或 <code class="docutils literal notranslate"><span class="pre">RawSql</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当提供超过 <code class="docutils literal notranslate"><span class="pre">$batchSize</span></code> 个字段/值对时,将执行多个查询,
每个处理最多 <code class="docutils literal notranslate"><span class="pre">$batchSize</span></code> 个字段/值对。 如果我们将 <code class="docutils literal notranslate"><span class="pre">$batchSize</span></code> 设置为 0,
则所有字段/值对将在一个查询中执行。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::updateFields">
<span class="sig-name descname"><span class="pre">updateFields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$set</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$addToDefault</span> <span class="pre">=</span> <span class="pre">false</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$ignore</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::updateFields" title="永久链接至目标"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 列的行或行数组,行是一个数组或对象</p></li>
<li><p><strong>$addToDefault</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 额外添加不在数据集中的列</p></li>
<li><p><strong>$ignore</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 忽略 $set 中的列数组</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>与 <code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">upsertBatch()</span></code> 方法一起使用。 这定义了要更新的字段。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::onConstraint">
<span class="sig-name descname"><span class="pre">onConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$set</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::onConstraint" title="永久链接至目标"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 用作键或约束的字段集或字段</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>与 <code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">upsertBatch()</span></code> 方法一起使用。 这接受逗号分隔的列字符串,数组,关联数组或 RawSql。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::setData">
<span class="sig-name descname"><span class="pre">setData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$set</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$alias</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::setData" title="永久链接至目标"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">在 4.3.0 版本加入.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 列的行或行数组,行是一个数组或对象</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
<li><p><strong>$alias</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 数据集的表别名</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>用于 <code class="docutils literal notranslate"><span class="pre">*Batch()</span></code> 方法为插入、更新、插入更新设置数据。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::setUpdateBatch">
<span class="sig-name descname"><span class="pre">setUpdateBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$key</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$escape</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::setUpdateBatch" title="永久链接至目标"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">自 4.3.0 版本弃用: </span>请使用 <a class="reference internal" href="#CodeIgniter\Database\BaseBuilder::setData" title="CodeIgniter\Database\BaseBuilder::setData"><code class="xref php php-meth docutils literal notranslate"><span class="pre">CodeIgniter\Database\BaseBuilder::setData()</span></code></a> 替代。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">mixed</span></code></span>) – 字段名称或字段/值对数组</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 如果 $key 是单个字段,则为字段值</p></li>
<li><p><strong>$escape</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否转义值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链)</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code></p>
</dd>
</dl>
<p>添加后面通过 <code class="docutils literal notranslate"><span class="pre">updateBatch()</span></code> 批量更新到表中的字段/值对。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>此方法不建议使用。将在未来版本中删除。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::replace" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array</span></code></span>) – 字段/值对的关联数组</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p>编译并执行 <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> 语句。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$where</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$limit</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$reset_data</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::delete" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$where</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – WHERE 子句</p></li>
<li><p><strong>$limit</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – LIMIT 子句</p></li>
<li><p><strong>$reset_data</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置查询的“写入”子句</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder</span></code> 实例(方法链),失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">BaseBuilder|false</span></code></p>
</dd>
</dl>
<p>编译并执行 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 查询。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::deleteBatch">
<span class="sig-name descname"><span class="pre">deleteBatch</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$set</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$constraints</span> <span class="pre">=</span> <span class="pre">null</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$batchSize</span> <span class="pre">=</span> <span class="pre">100</span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::deleteBatch" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$set</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|object|null</span></code></span>) – 字段名称,或字段/值对的关联数组</p></li>
<li><p><strong>$constraints</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">array|RawSql|string|null</span></code></span>) – 用作删除键的字段或字段集合</p></li>
<li><p><strong>$batchSize</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 每个查询要分组的条件数</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>删除的行数,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int|false</span></code></span></p>
</dd>
</dl>
<p>编译并执行批量 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 查询。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::increment">
<span class="sig-name descname"><span class="pre">increment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$column</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::increment" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$column</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要递增的列的名称</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 要在列中递增的值</p></li>
</ul>
</dd>
</dl>
<p>将字段的值递增指定的量。如果字段不是数值字段,比如 <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>,它可能会被 <code class="docutils literal notranslate"><span class="pre">$value</span></code> 替换。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::decrement">
<span class="sig-name descname"><span class="pre">decrement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">$column</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">$value</span> <span class="pre">=</span> <span class="pre">1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::decrement" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$column</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – 要递减的列的名称</p></li>
<li><p><strong>$value</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – 要在列中递减的值</p></li>
</ul>
</dd>
</dl>
<p>将字段的值递减指定的量。如果字段不是数值字段,比如 <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>,它可能会被 <code class="docutils literal notranslate"><span class="pre">$value</span></code> 替换。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::truncate">
<span class="sig-name descname"><span class="pre">truncate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::truncate" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code>,测试模式下返回字符串</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool|string</span></code></span></p>
</dd>
</dl>
<p>对表执行 <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code> 语句。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果使用的数据库平台不支持 <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>,
将使用 <code class="docutils literal notranslate"><span class="pre">DELETE</span> <span class="pre">FROM</span> <span class="pre">table</span></code> 代替。</p>
</div>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::emptyTable">
<span class="sig-name descname"><span class="pre">emptyTable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::emptyTable" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>成功则为 <code class="docutils literal notranslate"><span class="pre">true</span></code>,失败则为 <code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p>通过 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 语句从表中删除所有记录。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::getCompiledSelect">
<span class="sig-name descname"><span class="pre">getCompiledSelect</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::getCompiledSelect" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置当前的 QB 值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>编译后的 SQL 语句字符串</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span></p>
</dd>
</dl>
<p>编译 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 语句并将其作为字符串返回。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::getCompiledInsert">
<span class="sig-name descname"><span class="pre">getCompiledInsert</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::getCompiledInsert" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置当前的 QB 值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>编译后的 SQL 语句字符串</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span></p>
</dd>
</dl>
<p>编译 <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> 语句并将其作为字符串返回。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::getCompiledUpdate">
<span class="sig-name descname"><span class="pre">getCompiledUpdate</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::getCompiledUpdate" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置当前的 QB 值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>编译后的 SQL 语句字符串</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span></p>
</dd>
</dl>
<p>编译 <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> 语句并将其作为字符串返回。</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="CodeIgniter\Database\BaseBuilder::getCompiledDelete">
<span class="sig-name descname"><span class="pre">getCompiledDelete</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">$reset</span> <span class="pre">=</span> <span class="pre">true</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#CodeIgniter\Database\BaseBuilder::getCompiledDelete" title="永久链接至目标"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$reset</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – 是否重置当前的 QB 值</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>编译后的 SQL 语句字符串</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span></p>
</dd>
</dl>
<p>编译 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 语句并将其作为字符串返回。</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="helpers.html" class="btn btn-neutral float-left" title="查询辅助方法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="transactions.html" class="btn btn-neutral float-right" title="事务" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2019-2024 CodeIgniter 基金会.
      <span class="lastupdated">最后更新于 2024-07-11.
      </span></p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
  
<jinja2.runtime.BlockReference object at 0x7f64561f6190>

<div style="margin-top: 16px;">
  <p>由 <a href="https://codeigniter.org.cn">CodeIgniter 中国开发者社区</a>翻译并制作</p>
  <p style="margin-bottom: 0;">
    <a href="https://github.com/CodeIgniter-Chinese/codeigniter4-user-guide" target="_blank">Github 简体中文翻译</a>
    ·
    <a href="https://codeigniter-chinese.github.io/codeigniter4-user-guide/codeigniter_user_guide.zip">离线版压缩包下载</a>
    ·
    <a href="https://codeigniter-chinese.github.io/codeigniter4-user-guide/CodeIgniter.pdf">PDF 版下载</a>
  </p>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>